function Tengu() {
  var d,
    a = Array.prototype.slice.call(arguments),
    b = a.pop(),
    c = a[0] && "string" == typeof a[0] ? a : a[0];
  if (!(this instanceof Tengu)) return new Tengu(c, b);
  if (((this.a = 0), !c || "*" === c)) {
    c = [];
    for (d in Tengu.modules) Tengu.modules.hasOwnProperty(d) && c.push(d);
  }
  for (d = 0; d < c.length; d += 1) Tengu.modules[c[d]](this);
  b(this);
}
var VERSION_NUMBER = "2.003";
console.log("Loading Tengu v" + VERSION_NUMBER),
  (Tengu.protoype = {
    name: "Tengu JS",
    version: VERSION_NUMBER,
    getName: function () {
      return this.name;
    },
    getVersion: function () {
      return VERSION_NUMBER;
    },
  }),
  (Tengu.modules = {}),
  (Tengu.modules.template = function (a) {
    a.method = function () {};
  }),
  (Tengu.modules.debug = function (a) {
    var b = [],
      c = function (a) {
        var b = {};
        return a && "[object Function]" === b.toString.call(a);
      },
      d = function () {
        var a = Error.prepareStackTrace;
        Error.prepareStackTrace = function (a, b) {
          return b;
        };
        var b = new Error();
        Error.captureStackTrace(b, arguments.callee);
        var c = b.stack;
        return (Error.prepareStackTrace = a), c;
      },
      e = function () {
        return d()[1].getLineNumber();
      },
      f = function () {
        var a = e(),
          c = [],
          d = arguments[0];
        return b[a] >= d
          ? !1
          : (arguments.length < 2 || "number" != typeof d
              ? console.log.apply(console, arguments)
              : (b[a] || (b[a] = 0),
                (b[a] += 1),
                Array.prototype.push.apply(c, arguments),
                c.shift(),
                console.log.apply(console, c)),
            void 0);
      };
    (a.stackTrace = function () {
      return d();
    }),
      (a.lineNumber = function () {
        return e();
      }),
      (a.log = function () {
        console.log.apply(console, arguments);
      }),
      (a.logMultiple = function () {
        f.apply(this, arguments);
      }),
      (a.logOnce = function () {
        var c = e();
        return b[c]
          ? !1
          : ((b[c] = 1), console.log.apply(console, arguments), void 0);
      }),
      (a.encodeURI = function (a) {
        var b = function (a) {
            var b,
              c = "";
            for (b in a)
              a.hasOwnProperty(b) &&
                ((c += encodeURIComponent(b) + "=" + encodeURIComponent(a[b])),
                (c += "&"));
            return c.substring(0, c.length - 1);
          },
          c = typeof a;
        switch (c) {
          case "object":
            return b(a);
          case "string":
            return encodeURIComponent(a);
          default:
            throw new Error("Tengu.encodeURI - Bad data type:", c);
        }
        return !1;
      }),
      (a.safeWrap = function (a, b, d, e) {
        return function () {
          try {
            if (c(a)) return a.apply(this, arguments);
            if (c(d)) d();
            else if (null != d)
              throw new TypeError(
                "T.safeWrap: func is not a function, func: " + a
              );
          } catch (f) {
            if (!c(b)) throw f;
            b(f);
          } finally {
            c(e) && e();
          }
        };
      });
  }),
  (Tengu.modules.string = function (a) {
    (a.numToString = function (a, b) {
      if (((b = b || "0.00"), void 0 == a)) return void 0;
      if (null == a) return null;
      var f,
        c = ("" + a).split("."),
        d = b.split("."),
        e = [2];
      for (f = d[0].length - c[0].length, e[0] = ""; f > 0; )
        (e += "0"), (f -= 1);
      for (
        e[0] += c[0],
          f = d[1].length - c[1].length,
          void 0 == c[1] && (c[1] = ""),
          void 0 == d[1] && (d[1] = ""),
          e[1] = c[1];
        f > 0;

      )
        (e[1] += "0"), (f -= 1);
      return 0 > f && (e[1] = c[1].slice(0, d[1].length)), e[0] + "." + e[1];
    }),
      (a.numToString_minDigits = function (a, b) {
        for (var c = "" + a; c.length < b; ) c = "0" + c;
        return c;
      }),
      (a.capitalizeFirstLetter = function (a) {
        return (a = a.toLowerCase()), a.charAt(0).toUpperCase() + a.slice(1);
      });
  }),
  (Tengu.modules.validation = function (a) {
    a.validateDate = function (a) {
      var b = a;
      if ("" == b) return !1;
      var c = /^(\d{1,2})(\/|-)(\d{1,2})(\/|-)(\d{4})$/,
        d = b.match(c);
      if (null == d) return !1;
      if (
        ((dtMonth = d[1]),
        (dtDay = d[3]),
        (dtYear = d[5]),
        1 > dtMonth || dtMonth > 12)
      )
        return !1;
      if (1 > dtDay || dtDay > 31) return !1;
      if (
        (4 == dtMonth || 6 == dtMonth || 9 == dtMonth || 11 == dtMonth) &&
        31 == dtDay
      )
        return !1;
      if (2 == dtMonth) {
        var e = 0 == dtYear % 4 && (0 != dtYear % 100 || 0 == dtYear % 400);
        if (dtDay > 29 || (29 == dtDay && !e)) return !1;
      }
      return !0;
    };
  }),
  (Tengu.modules.namegen = function (a) {
    var i,
      j,
      b = 20,
      c = 3,
      d = {},
      e = function (b) {
        var d,
          c = { loc: [], next: [] };
        for (d in b.loc) c.loc[d] = a.normalize(b.loc[d]);
        for (d in b.next) c.next[d] = a.normalize(b.next[d]);
        return c;
      },
      f = { nextScalar: 0.5, locScalar: 0.5, randScalar: 0 },
      g = 1 / 27,
      h = function () {
        return Math.random();
      };
    (i = "bcdfghjklmnpqrstvwxyz".split("")),
      (j = "aeiou".split("")),
      (a.getRandomConsonant = function () {
        return a.randArrayValue(i, h);
      }),
      (a.getRandomVowel = function () {
        return a.randArrayValue(j, h);
      }),
      (a.namegenSetRFunc = function (a) {
        h = a;
      }),
      (a.makeNationName = function () {
        var b = "",
          c = Math.floor(4 * Math.random());
        switch (
          ((b += a.getRandomConsonant()),
          (b += a.getRandomVowel()),
          (b += a.getRandomConsonant()),
          0 != c && ((b += a.getRandomVowel()), (b += a.getRandomConsonant())),
          c)
        ) {
          case 0:
            b += "land";
            break;
          case 1:
            b += "ia";
            break;
          case 2:
            b += "y";
            break;
          case 3:
            b += "";
        }
        return a.capitalizeFirstLetter(b);
      }),
      (a.namegenLearn = function (b) {
        var f,
          g,
          h,
          i,
          j,
          k,
          l,
          c = [],
          d = [],
          e = null;
        for (f = 0; 27 > f; f += 1) d[f] = a.zeroArray(27);
        for (i = b.length, f = 0; i > f; f++) {
          for (
            k = b[f].replace("[^a-zA-Z]", "").toUpperCase(),
              j = b[f].length,
              e = 26,
              g = 0;
            j > g;
            g++
          )
            (l = k.charCodeAt(g) - 65),
              void 0 === c[g] && (c[g] = a.zeroArray(27)),
              (c[g][l] += 1),
              (d[e][l] += 1),
              (e = l);
          if (void 0 === c[g])
            for (c[g] = [27], h = 0; 27 > h; h += 1) c[g][h] = 0;
          (c[g][26] += 1), null == e ? (d[26][26] += 1) : (d[e][26] += 1);
        }
        return { loc: c, next: d };
      }),
      (a.namegenUpdate = function (a) {
        d = e(a);
      }),
      (a.namegenCreate = function () {
        var t,
          v,
          w,
          x,
          e = f.nextScalar,
          i = f.locScalar,
          j = f.randScalar,
          k = g,
          l = d.next,
          m = d.loc,
          n = !1,
          o = 0,
          p = [],
          q = 26,
          r = a.zeroArray(27),
          s = "";
        for (r[26] = 1; !n; ) {
          for (p = a.zeroArray(27), v = 27, t = 0; v > t; t += 1)
            (p[t] += l[q][t] * e),
              (p[t] += o > m.length - 1 ? r[t] * i : m[o][t] * i),
              (p[t] += k * j);
          for (
            c > o && ((p[26] = 0), (p = a.normalize(p))), w = h(), x = 0, t = 0;
            w >= x;

          )
            (x += p[t]), (t += 1);
          (t -= 1),
            t >= 26
              ? (n = !0)
              : ((s += String.fromCharCode(t + 65)),
                (q = t),
                s.length >= b && (n = !0)),
            (o += 1);
        }
        return s;
      });
  }),
  (Tengu.modules.math = function (b) {
    (b.sign = function (a) {
      return "number" == typeof a
        ? a
          ? 0 > a
            ? -1
            : 1
          : a === a
          ? 0
          : 0 / 0
        : 0 / 0;
    }),
      (b.isEven = function (a) {
        return 0 == a % 2;
      }),
      (b.isOdd = function (a) {
        return !b.isEven(a);
      }),
      (b.rez = function (a, b) {
        return Math.floor(a / b) * b;
      }),
      (b.nInRange = function (a, b, c) {
        return 0 > (a - b) * (a - c);
      }),
      (b.capNumber = function (a, b, c) {
        return (
          "number" != typeof a && console.warn("" + a + " is not a number!"),
          void 0 != b && b > a ? b : void 0 != c && a > c ? c : a
        );
      }),
      (b.logrithm = (function () {
        var a = Math.log;
        return function (b, c) {
          return a(b) / (c ? a(c) : 1);
        };
      })()),
      (b.pointRect = function (a, b, c) {
        return !((a > c.x + c.w) | (a < c.x) | (b > c.y + c.h) | (b < c.y));
      }),
      (b.pointDir = function (a, b, c, d) {
        var e = c - a,
          f = d - b,
          g = Math.atan2(-f, e);
        return g;
      }),
      (b.pointDisSq = function (a, b, c, d) {
        var e = c - a,
          f = d - b;
        return e * e + f * f;
      }),
      (b.pointDis = function (a, c, d, e) {
        return Math.sqrt(b.pointDisSq(a, c, d, e));
      }),
      (b.lineIntersect1D = function (a, b, c, d) {
        var e = a + b,
          f = c + d;
        return !(e > c || a > f);
      }),
      (b.rectIntersect2D = function () {}),
      (b.bitArrayToByte = function (a, b) {
        b && a.reverse();
        var c,
          d = 0;
        for (c = 0; 8 > c; c += 1) a[c] && (d += Math.pow(2, c));
        return d;
      }),
      (b.byteToBitArray = function (b, c) {
        var e,
          d = [];
        for (e = 0; 8 > e; e += 1) d[e] = 1 & (a >> e);
        return c && d.reverse(), d;
      }),
      (b.statistics = function (a) {
        if (!b.isArray(a))
          return console.warn("T.statistics - invalid array:", a), !1;
        if (a.length < 1)
          return console.warn("T.statistics - array is empty:", a), !1;
        var c,
          d,
          e = function (a) {
            var d,
              e,
              c = 0;
            for (d in a) (e = a[d]), b.isValidNum(e) && (c += e);
            return (c /= a.length);
          },
          f = function (a, c) {
            var e,
              f,
              g,
              d = 0;
            for (e in a)
              (f = a[e]), b.isValidNum(f) && ((g = f - c), (d += g * g));
            return d / (a.length - 1);
          };
        return (
          (c = e(a)),
          (d = f(a, c)),
          { mean: c, v: d, sd: Math.sqrt(d), ss: a.length }
        );
      });
  }),
  (Tengu.modules.fingerprint = function (a) {
    var b = function (b, c, d) {
        if (!a.isObject(b) || !a.isArray(d))
          return (
            console.error(
              "Tengu fingerprint - _mapData, bad objects or schema",
              b,
              a.isObject(b),
              d,
              a.isArray(d)
            ),
            c
          );
        a.isObject(c) || (c = {});
        var e, f;
        for (e in d) (f = d[e]), (c[f] = b[f]);
        return c;
      },
      c = function (a) {
        var c = [
          "appCodeName",
          "appName",
          "appVersion",
          "cookieEnabled",
          "doNotTrack",
          "hardwareConcurrency",
          "language",
          "languages",
          "maxTouchPoints",
          "mimeTypes",
          "platform",
          "plugins",
          "product",
          "productSub",
          "userAgent",
          "vendor",
          "vendorSub",
        ];
        return b(window.navigator, a, c);
      },
      d = function (a) {
        var c = [
          "availHeight",
          "availLeft",
          "availTop",
          "availWidth",
          "colorDepth",
          "height",
          "pixelDepth",
          "width",
        ];
        return b(window.screen, a, c);
      },
      e = function (a) {
        var b = window.screen.width,
          c = window.screen.height;
        return (
          b > c
            ? ((a.screen_long = b), (a.screen_short = c))
            : ((a.screen_long = c), (a.screen_short = b)),
          a
        );
      },
      f = function () {
        var a = {};
        return (a = c(a)), (a = d(a)), (a = e(a));
      };
    a.getDeviceData = function () {
      return f();
    };
  }),
  (Tengu.modules.sha3_512 = function (a) {
    (a.sha3_512 = function () {}), (a.saltySha3 = function () {});
  }),
  (Tengu.modules.physics = function (a) {
    a.getDisVTA = function (a, b, c) {
      var e,
        d = b * b;
      return (e = a * b + 0.5 * c * d);
    };
  }),
  (Tengu.modules.random = function (a) {
    var b = 279470273,
      c = [],
      d = function () {
        var b, d, e, f, g;
        do
          (b = 2 * a.prFloat() - 1),
            (d = 2 * a.prFloat() - 1),
            (e = b * b + d * d);
        while (e >= 1);
        (e = Math.sqrt((-2 * Math.log(e)) / e)),
          (f = b * e),
          (g = d * e),
          c.push(f),
          c.push(g);
      };
    (a.uInt32 = function (a) {
      return (a = Math.abs(a)), (a = Math.round(a)), (a %= 4294967296);
    }),
      (a.randomSeed = function () {
        return a.uInt32(4294967296 * Math.random());
      }),
      (a.hash = function (b) {
        return (
          (b = a.uInt32(b)),
          (b += ~(b << 15)),
          (b ^= b >> 10),
          (b += b << 3),
          (b ^= b >> 6),
          (b += ~(b << 11)),
          (b ^= b >> 16)
        );
      }),
      (a.makeSeed = function () {
        var d,
          e,
          b = Array.prototype.slice.call(arguments),
          c = function () {
            var c = b.pop(),
              d = a.uInt32(c);
            return a.hash(d);
          };
        if (b.length <= 0) return a.randomSeed();
        for (d = c(); b.length > 0; ) (e = c()), (d = a.hash(d ^ e));
        return d;
      }),
      (a.lehmer = function (a) {
        return (279470273 * a) % 4294967291;
      }),
      (a.seed = function (a) {
        return (c = []), (b = a);
      }),
      (a.prng = function () {
        var c = a.lehmer(b);
        return (b = c), c;
      }),
      (a.prFloat = function () {
        return a.prng() / 4294967296;
      }),
      (a.prBool = function () {
        return a.prng() >= 2147483648;
      }),
      (a.prInt = function (b, c) {
        var d = a.prng();
        return (
          void 0 === c && (c = 0),
          (d /= 4294967296),
          (d *= b - c),
          (d = Math.floor(d)),
          (d += c)
        );
      }),
      (a.prGauss = function () {
        return c.length <= 0 && d(), c.pop();
      });
  }),
  (Tengu.modules.util = function (a) {
    var b = (function () {
      var a = window.location.pathname,
        b = a.lastIndexOf("/") + 1;
      return (a = a.slice(0, b));
    })();
    (a.argArray = function (a) {
      return Array.prototype.slice.call(a, 0);
    }),
      (a.getWorkingDir = function () {
        return b;
      }),
      (a.versionToFloat = function (a) {
        var b = a.indexOf("."),
          c = a.slice(0, b).replace(/\D/g, ""),
          d = a.slice(b).replace(/\D/g, ""),
          e = c + "." + d;
        return parseFloat(e);
      }),
      (a.isUpperCase = function (a) {
        return a == a.toUpperCase();
      }),
      (a.isLowerCase = function (a) {
        return a == a.toLowerCase();
      }),
      (a.isString = function (a) {
        if (!a) return !1;
        var b = Object.prototype.toString;
        return "[object String]" == b.call(a);
      }),
      (a.isNumOrString = function (b) {
        return a.isValidNum(b) ? !0 : a.isString(b) ? !0 : !1;
      }),
      (a.isArray = function (a) {
        if (!a) return !1;
        var b = Object.prototype.toString;
        return "[object Array]" == b.call(a);
      }),
      (a.isFunction = function (a) {
        if (!a) return !1;
        var b = {};
        return a && "[object Function]" === b.toString.call(a);
      }),
      (a.isObject = function (a) {
        return a ? "object" == typeof a : !1;
      }),
      (a.isValidNum = function (a) {
        return null == a ? !1 : "number" == typeof a && 0 / 0 != a;
      }),
      (a.isNumber = a.isValidNum),
      (a.isValidNumber = a.isValidNum),
      (a.isInt = function (b) {
        return a.isValidNum(b) ? 0 == b % 1 : !1;
      }),
      (a.shuffle = function (a) {
        for (
          var b, c, d = a.length;
          d;
          b = Math.floor(Math.random() * d), c = a[--d], a[d] = a[b], a[b] = c
        );
        return a;
      }),
      (a.randArrayValue = function (a, b) {
        b = b || Math.random;
        var c = a.length,
          d = Math.floor(b() * c);
        return a[d];
      }),
      (a.indexObjArray = function (a) {
        var b, c;
        for (c = a.length, b = 0; c > b; b += 1) a[b].index = b;
        return a;
      }),
      (a.search = function (a, b, c) {
        var e,
          f,
          d = [];
        for (f = a.length, e = 0; f > e; e += 1)
          void 0 != a[e] && a[e][b] == c && d.push(e);
        return d;
      }),
      (a.searchIndexOf = function (b, c, d) {
        var e = a.search(b, c, d);
        return e.length > 0 ? e[0] : -1;
      }),
      (a.arrayRemoveValue = function (a) {
        for (var b, e, d = a.length; d > 1 && a.length; )
          for (b = a[--d]; -1 !== (e = a.indexOf(b)); ) a.splice(e, 1);
        return a;
      }),
      (a.appendArray = function (a, b) {
        return Array.prototype.push.apply(a, b);
      }),
      (a.stringReplaceAll = function (a, b, c, d) {
        return a.replace(
          new RegExp(
            b.replace(
              /([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,
              "\\$&"
            ),
            d ? "gi" : "g"
          ),
          "string" == typeof c ? c.replace(/\$/g, "$$$$") : c
        );
      }),
      (a.safeDQuoteString = function (b) {
        return (
          a.stringReplaceAll(b, '"', '\\"'), a.stringReplaceAll(b, "\\", "\\\\")
        );
      }),
      (a.sort = (function () {
        "use strict";
        return function (a, b) {
          for (var c = 0, d = a.length; d > c; c++) {
            for (
              var e = c, f = a[e][b], g = a[e];
              e > 0 && a[e - 1][b] > f;
              e--
            )
              a[e] = a[e - 1];
            a[e] = g;
          }
          return a;
        };
      })()),
      (a.keyNverse = function (a) {
        var c,
          d,
          b = {};
        for (c in a) (d = a[c]), (b[d] = c);
        return b;
      }),
      (a.zeroArray = function (a) {
        var c,
          b = [];
        for (c = 0; a > c; c += 1) b.push(0);
        return b;
      }),
      (a.emptyStringArray = function (a) {
        var c,
          b = [];
        for (c = 0; a > c; c += 1) b.push("");
        return b;
      }),
      (a.normalize = function (a) {
        var c,
          d,
          e,
          b = 0;
        for (d = a.length, c = 0; d > c; c += 1) {
          if ("number" != typeof a[c])
            throw new Error("Array[" + c + "] is not a number!  Val:" + a[c]);
          b += a[c];
        }
        if (0 == b) for (e = 1 / d, c = 0; d > c; c += 1) a[c] = e;
        else for (c = 0; d > c; c += 1) a[c] /= b;
        return a;
      }),
      (a.object = function (a) {
        function b() {}
        return (b.prototype = a), new b();
      }),
      (a.clone = function (a) {
        return a ? (a instanceof Array ? a.slice(0) : jQuery.extend({}, a)) : a;
      }),
      (a.cloneDeep = function (a) {
        return a
          ? a instanceof Array
            ? a.slice(0)
            : jQuery.extend(!0, {}, a)
          : a;
      }),
      (a.mapObj = function (a, b) {
        var c;
        for (c in a) b[c] = a[c];
        return b;
      }),
      (a.objToArray = function (a) {
        var c,
          b = [];
        for (c in a) b.push(a[c]);
        return b;
      }),
      (a.makeGetter = function (b, c) {
        var f,
          d = b,
          e = {};
        for (f in d)
          e[f] = (function () {
            var b = f;
            return function () {
              return a.isFunction(d[b]) && c
                ? (d[b].apply(this, arguments), void 0)
                : d[b];
            };
          })();
        return e;
      }),
      (a.bind = function (a, b) {
        return function () {
          b.apply(a, arguments);
        };
      }),
      (a.createCallback = function (a, b) {
        return function (c) {
          b.call(a, c);
        };
      }),
      (a.binToString = function (a) {
        var b = a;
        if ((b.byteLength % 2 > 0, !(b instanceof ArrayBuffer)))
          throw new Error("T.webstorage: Invalid ArrayBuffer", b);
        return String.fromCharCode.apply(null, new Uint16Array(b));
      }),
      (a.stringToBin = function (a) {
        var d,
          e,
          b = new ArrayBuffer(2 * a.length),
          c = new Uint16Array(b);
        for (e = a.length, d = 0; e > d; d += 1) c[d] = a.charCodeAt(d);
        return b;
      }),
      (a.rgba = function (a) {
        var c,
          d,
          e,
          f,
          b = a.replace("#", ""),
          g = [];
        for (d = 0; 4 > d; d += 1) {
          if (
            ((e = 2 * d),
            (c = b.slice(e, e + 2)),
            (f = parseInt(c, 16)),
            "number" != typeof f)
          )
            throw new Error("Invalid rgba color string: " + a);
          g.push(f);
        }
        return (
          (g[3] /= 256),
          "rgba(" + g[0] + "," + g[1] + "," + g[2] + "," + g[3] + ")"
        );
      }),
      (a.rgbToString = function (a, b, c) {
        return (
          a &&
            void 0 === b &&
            void 0 === c &&
            ((b = a.g), (c = a.b), (a = a.r)),
          "rgb(" +
            Math.round(a) +
            "," +
            Math.round(b) +
            "," +
            Math.round(c) +
            ")"
        );
      }),
      (a.hsvToRgb = function (a, b, c) {
        var d, e, f, g, h, i, j, k;
        switch (
          (a &&
            void 0 === b &&
            void 0 === c &&
            ((b = a.s), (c = a.v), (a = a.h)),
          (g = Math.floor(6 * a)),
          (h = 6 * a - g),
          (i = c * (1 - b)),
          (j = c * (1 - h * b)),
          (k = c * (1 - (1 - h) * b)),
          g % 6)
        ) {
          case 0:
            (d = c), (e = k), (f = i);
            break;
          case 1:
            (d = j), (e = c), (f = i);
            break;
          case 2:
            (d = i), (e = c), (f = k);
            break;
          case 3:
            (d = i), (e = j), (f = c);
            break;
          case 4:
            (d = k), (e = i), (f = c);
            break;
          case 5:
            (d = c), (e = i), (f = j);
        }
        return {
          r: Math.floor(255 * d),
          g: Math.floor(255 * e),
          b: Math.floor(255 * f),
        };
      }),
      (a.getDLURLfromString = function (b, c, d) {
        var e = "text/plain";
        a.isString(d) && (e = d), (window.URL = window.webkitURL || window.URL);
        var f = new Blob([b], { type: e }),
          g = document.getElementById("dlLink");
        (g.download = c),
          (g.href = window.URL.createObjectURL(f)),
          g.click(),
          (g.download = ""),
          (g.href = "");
      }),
      (a.randomBool = function () {
        return Math.random() < 0.5;
      }),
      (a.disableRightClick = function () {
        function b() {
          return document.all ? !1 : void 0;
        }
        function c(b) {
          return !(
            document.layers ||
            (document.getElementById && !document.all)
          ) ||
            (2 != b.which && 3 != b.which)
            ? void 0
            : !1;
        }
        document.layers
          ? (document.captureEvents(Event.MOUSEDOWN),
            (document.onmousedown = c))
          : ((document.onmouseup = c), (document.oncontextmenu = b)),
          (document.oncontextmenu = new Function("return false"));
      }),
      (a.getScreenResolution = function () {
        return { w: screen.width, h: screen.height };
      });
  }),
  (Tengu.modules.afk = function (a) {
    var b = [],
      c = function (a) {
        a.timeout && window.clearTimeout(a.timeout);
        try {
          a.timeout = window.setTimeout(a.callback, a.duration);
        } catch (b) {
          throw (console.log(b), b);
        }
      },
      d = function () {
        var a;
        for (a in b) b[a] && c(b[a]);
      },
      e = function (a, d) {
        var e = b.length;
        return (b[e] = { duration: d, callback: a }), c(e), e;
      },
      f = function (a) {
        var c = b[a];
        c.timeout && window.clearTimeout(c.timeout), (b[a] = void 0);
      };
    $(document).ready(function () {
      var b,
        c,
        a = ["pointerdown", "pointerup", "pointermove", "onkeydown"];
      for (c = a.length, b = 0; c > b; b += 1) window.addEventListener(a[b], d);
    }),
      (a.clearAfk = function (a) {
        f(a);
      }),
      (a.afk = function (a, b) {
        return e(a, b);
      });
  }),
  (Tengu.modules.cookie = function (a) {
    (a.setCookie = function (a, b, c) {
      var d = new Date();
      d.setTime(d.getTime() + 1e3 * 60 * 60 * 24 * c);
      var e = "expires=" + d.toGMTString();
      document.cookie = a + "=" + b + "; " + e;
    }),
      (a.getCookie = function (a) {
        for (
          var b = a + "=", c = document.cookie.split(";"), d = 0;
          d < c.length;
          d++
        ) {
          var e = c[d].trim();
          if (0 == e.indexOf(b)) return e.substring(b.length, e.length);
        }
        return "";
      });
  }),
  (Tengu.modules.webworker = function (a) {
    (a.startWorker = function (a, b) {
      var c;
      if ("undefined" == typeof Worker)
        throw new Error("Browser does not support Web Workers");
      (c = new Worker(a)),
        (c.onmessage = function (a) {
          b(a.data);
        });
    }),
      (a.stopWorker = function (a) {
        a.terminate();
      });
  }),
  (Tengu.modules.stream = function (a) {
    var b = 2,
      c = function () {
        return void 0 !== DataView;
      },
      d = function () {
        if (c) {
          var a = new ArrayBuffer(2);
          return (
            new DataView(a).setInt16(0, 256, !0), 256 === new Int16Array(a)[0]
          );
        }
        return void 0;
      },
      e = null,
      f = 0,
      g = [],
      h = g,
      i = function () {
        return h;
      },
      l = function (a) {
        switch (a) {
          case "uint8":
            return 1;
          case "uint16":
            return 2;
          case "uint32":
            return 4;
          default:
            throw new Error("Unknown size of type: " + a);
        }
      },
      m = function (a) {
        var b,
          c,
          d = 0;
        for (a = a || i(), c = a.length, b = 0; c > b; b += 1)
          d += l(a[b].type);
        return d;
      },
      n = function (a, b, c, d) {
        switch (b) {
          case "uint8":
            return a.getUint8(c);
          case "uint16":
            return a.getUint16(c, d);
          case "uint32":
            return a.getUint32(c, d);
          case "int8":
            return a.getInt8(c);
          case "int16":
            return a.getInt16(c, d);
          case "int32":
            return a.getInt32(c, d);
          case "float32":
            return a.getFloat32(c, d);
          case "float64":
            return a.getFloat64(c, d);
          default:
            throw new Error("Bad DataView Type: " + b);
        }
        return a;
      },
      o = function (a, b, c, d) {
        switch (c) {
          case "uint8":
            a.setUint8(d, b);
            break;
          case "uint16":
            a.setUint16(d, b);
            break;
          case "uint32":
            a.setUint32(d, b);
            break;
          case "int8":
            a.setInt8(d, b);
            break;
          case "int16":
            a.setInt16(d, b);
            break;
          case "int32":
            a.setInt32(d, b);
            break;
          case "float32":
            a.setFloat32(d, b);
            break;
          case "float64":
            a.setFloat64(d, b);
            break;
          default:
            throw new Error("Bad DataView Type: " + c);
        }
        return a;
      },
      p = function () {
        var a,
          c,
          d,
          e,
          f,
          g,
          h = 0;
        for (a = i(), c = m(); c % b > 0; ) v(0, "uint8"), (c += 1);
        for (
          d = new ArrayBuffer(c), e = new DataView(d), g = a.length, f = 0;
          g > f;
          f += 1
        )
          o(e, a[f].value, a[f].type, h), (h += l(a[f].type));
        return console.log("Binary created - " + d.byteLength + " bytes"), d;
      },
      r = function (a) {
        var d,
          e,
          b = a.byteLength,
          c = new DataView(a);
        for (d = 0; b > d; d += 1)
          (e = "" + d + ": "), (e += c.getUint8(d)), console.log(e);
      },
      t = function (b) {
        if (!a.isString(b))
          throw new Error("T.stream: " + b + " is not a string!");
        switch ((b = b.toLowerCase())) {
          case "uint8":
          case "uint16":
          case "uint32":
            return b;
          default:
            throw new Error("T.stream: Invalid data type (" + b + ")");
        }
      },
      u = function (b, c) {
        var d, e, f, g, h;
        switch (c) {
          case "uint8":
          case "uint16":
          case "uint32":
            (e = !0), (f = !0);
            break;
          default:
            (e = !1), (f = !1);
        }
        switch (c) {
          case "uint8":
            d = 255;
            break;
          case "uint16":
            d = 65535;
            break;
          case "uint32":
            d = 4294967295;
        }
        return (
          "bool" == typeof b && (b = b ? 1 : 0),
          f && (b = Math.floor(b)),
          (g = a.sign(b)),
          (h = Math.abs(b)),
          h > d && (b = d * g),
          e && 0 > b && (b = d - (b + 1)),
          b
        );
      },
      v = function (a, b) {
        var c,
          d,
          e = i();
        (c = t(b)), (d = u(a, c)), e.push({ value: d, type: c });
      },
      w = function (a, b, c, d) {
        var g, h, i;
        if (((b = b || e), !(b instanceof ArrayBuffer)))
          throw new Error("T.stream: Nonexistent array buffer");
        return (
          (h = new DataView(b)),
          (a = t(a)),
          (g = c ? c : f),
          (i = n(h, a, g, d)),
          c || (f += l(a)),
          i
        );
      };
    (_loadArrayBuffer = function (a) {
      return (e = a), (f = 0), a;
    }),
      (a.isLittleEndian = function () {
        return d;
      }),
      (a.streamCreate = function () {
        return (g = []), (h = g);
      }),
      (a.streamOpen = function (a) {
        return _loadArrayBuffer(a);
      }),
      (a.streamWrite = function (a, b) {
        v(a, b);
      }),
      (a.streamRead = function (a, b) {
        return w(a, void 0, void 0, b);
      }),
      (a.streamGetArrayBuffer = function (a) {
        return (a = a || h), p();
      }),
      (a.logArrayBuffer = function (a) {
        r(a);
      });
  }),
  (Tengu.modules.xhr_old = function (a) {
    var c = function (a) {
        var b = new XMLHttpRequest();
        return b.open("HEAD", a, !1), b.send(null), 200 === b.status;
      },
      d = function (a) {
        var c,
          d,
          e,
          b = new XMLHttpRequest();
        return (
          b.open("HEAD", a, !1),
          b.send(null),
          200 === b.status
            ? ((c = b.getResponseHeader("Last-Modified")),
              (d = new Date(c)),
              (e = d.getTime()))
            : (e = void 0),
          e
        );
      },
      e = function (a, b, c) {
        c =
          c ||
          function (a) {
            console.warn(a);
          };
        var d = new XMLHttpRequest();
        (d.onreadystatechange = function () {
          4 === d.readyState &&
            (200 === d.status
              ? b && b(d.responseText)
              : c && (console.log("xhr", d), c(d)));
        }),
          d.open("GET", a, !0),
          d.send();
      },
      f = function (a, b, c) {
        var d = function (a) {
          b(JSON.parse(a));
        };
        e(a, d, c);
      };
    (a.xhrFileExists = function (a) {
      return c(a);
    }),
      (a.xhrGetDateModified = function (a) {
        return d(a);
      }),
      (a.xhrGetJSON = function (a, b, c) {
        return f(a, b, c);
      });
  }),
  (Tengu.modules.xhr = function (a) {
    var b = function () {
        var a;
        if (window.XMLHttpRequest) a = new XMLHttpRequest();
        else if (window.ActiveXObject)
          try {
            a = new ActiveXObject("Msxml2.XMLHTTP");
          } catch (b) {
            try {
              a = new ActiveXObject("Microsoft.XMLHTTP");
            } catch (b) {
              throw b;
            }
          }
        if (a) return a;
        throw new Error("Cannot create XHR instance");
      },
      d = function (b, c) {
        switch (b.status) {
          case 200:
            a.isFunction(c.success) && c.success(),
              a.isFunction(c.done) && c.done();
            break;
          default:
            a.isFunction(c.fail) && c.fail();
        }
        a.isFunction(c.always) && c.always();
      },
      e = function (a, b) {
        var c;
        for (c in b)
          "string" == typeof c &&
            "string" == typeof b[c] &&
            (console.log("set header", c, b[c]), a.setRequestHeader(c, b[c]));
      },
      f = function (c, f, g, h, i, j) {
        var k = b(),
          l = { success: null, done: null, fail: null, always: null },
          m = {
            success: function (a) {
              return (l.success = a), m;
            },
            done: function (a) {
              return (l.done = a), m;
            },
            fail: function (a) {
              return (l.fail = a), m;
            },
            always: function (a) {
              return (l.always = a), m;
            },
          };
        return (
          a.isFunction(h) && (l.success = h),
          k.open(c, f, !0),
          "string" == typeof i && k.setRequestHeader("Content-Type", i),
          a.isObject(j) && e(k, j),
          d(k, l),
          k.send(),
          m
        );
      };
    (a.get = function (a, b, c, d, e) {
      return f("GET", a, b, c, d, e);
    }),
      console.log("T.post defined"),
      (a.post = function (a, b, c, d, e) {
        return console.log("T.post called"), f("POST", a, b, c, d, e);
      }),
      (a.getDateModified = function (a) {
        var c,
          b = new XMLHttpRequest();
        return (
          b.open("HEAD", a, !1),
          b.send(null),
          (c = b.getResponseHeader("Last-Modified"))
        );
      });
  }),
  (Tengu.modules.appcache = function (a) {
    if (!window.applicationCache) return !1;
    var b = !1,
      c = [];
    (window.applicationCache.onerror = function () {
      var a, d;
      for (b = !0, d = c.length, a = 0; d > a; a += 1) c[a]();
      return !1;
    }),
      (a.appCache_getStatus = function () {
        var a = window.applicationCache;
        switch (a.status) {
          case a.UNCACHED:
            return "UNCACHED";
          case a.IDLE:
            return "IDLE";
          case a.CHECKING:
            return "CHECKING";
          case a.DOWNLOADING:
            return "DOWNLOADING";
          case a.UPDATEREADY:
            return "UPDATEREADY";
          case a.OBSOLETE:
            return "OBSOLETE";
          default:
            return "UKNOWN CACHE STATUS";
        }
      }),
      (a.appCacheOffline = function () {
        return b;
      }),
      (a.appCache_onOffline = function (a) {
        b ? a() : c.push(a);
      });
  }),
  (Tengu.modules.fileio = function (a) {
    (a.writeJSON = function (b, c, d, e) {
      var f = JSON.stringify(d),
        g = a.getWorkingDir() + c;
      $.ajax({
        url: b,
        data: { filename: g, str: f },
        type: "POST",
        success: function () {
          e();
        },
        dataType: "text/json",
      });
    }),
      (a.readJSON = function (a, b) {
        $.ajax({
          url: a,
          cache: !1,
          success: function (a) {
            b(a);
          },
          dataType: "text/json",
        });
      }),
      (a.readTXT = function (a, b) {
        $.ajax({
          url: a,
          cache: !1,
          success: function (a) {
            b(a);
          },
          dataType: "text",
        });
      });
  }),
  (Tengu.modules.webstorage = function (a) {
    var i,
      b = function () {
        return "undefined" != typeof Storage;
      },
      c = function () {
        if (!b) throw new Error("Web Storage Unavailable");
      },
      d = function (a) {
        if (!(a instanceof ArrayBuffer))
          throw new Error("T.webstorage: Invalid ArrayBuffer", a);
        return String.fromCharCode.apply(null, new Uint16Array(a));
      },
      e = function (a) {
        var d,
          e,
          b = new ArrayBuffer(2 * a.length),
          c = new Uint16Array(b);
        for (e = a.length, d = 0; e > d; d += 1) c[d] = a.charCodeAt(d);
        return b;
      },
      f = function (a) {
        var b = ["string", "bool", "int", "float", "json", "bin"];
        return b.indexOf(a) >= 0;
      },
      g = function (a, b) {
        switch ((void 0 == b && (b = "string"), b)) {
          case "string":
          case "bool":
          case "int":
          case "float":
            return "" + a;
          case "json":
            return JSON.stringify(a);
          case "bin":
            return d(a);
        }
      },
      h = function (a, b) {
        switch ((void 0 == b && (b = "string"), a)) {
          case void 0:
            return void 0;
          case "undefined":
            return void 0;
          case "null":
            return null;
          case "":
            return void 0;
        }
        switch (b) {
          case "string":
            return a;
          case "bool":
            return !(
              "0" == a ||
              "false" == a ||
              "null" == a ||
              "undefined" == a ||
              "NaN" == a
            );
          case "int":
            return parseInt(a);
          case "float":
            return parseFloat(a);
          case "json":
            return JSON.parse(a);
          case "bin":
            return e(a);
        }
      },
      j = "";
    !(function () {
      i = void 0 != navigator.webkitPersistentStorage;
    })();
    var k = function () {
        return (0 | (65536 * (1 + Math.random()))).toString(16).substring(1);
      },
      l = function (a) {
        var b = localStorage[j + "." + a];
        return "string" == typeof b ? b.split("Â¬") : [];
      },
      m = function (b, c) {
        if (!a.isArray(c))
          throw new Error("_db_array_set: Invalid array - " + c);
        localStorage[j + "." + b] = c.join("Â¬");
      },
      o = function (a, b) {
        if ("string" != typeof b)
          throw new Error("_db_array_append data must be string.");
        var c = l(a);
        c.push(b), m(a, c);
      },
      p = function (a, b) {
        var c = l(a);
        c.splice(c.indexOf(b), 1), console.log("arrayRemove", b, c), m(a, c);
      },
      q = function () {
        return (
          k() + k() + "-" + k() + "-" + k() + "-" + k() + "-" + k() + k() + k()
        );
      },
      t = function (a) {
        var c,
          b = [
            j + "." + a + ".schema_columnName",
            j + "." + a + ".schema_columnType",
            j + "." + a + ".guidList",
          ];
        for (c in b) if (!localStorage[b[c]]) return !1;
        return !0;
      },
      u = function (a, b) {
        var e,
          c = [],
          d = [];
        for (e in b) {
          if ("string" != typeof e) throw new Error("Invalid Name: " + e);
          if (!f(b[e])) throw new Error("Invalid Type: " + b[e]);
          c.push(e), d.push(b[e]);
        }
        m(a + ".schema_columnName", c),
          m(a + ".schema_columnType", d),
          m(a + ".guidList", []);
      },
      v = function (a, b, c) {
        var d = l(a + ".schema_columnName"),
          e = l(a + ".schema_columnType");
        if ("string" != typeof b) throw new Error("Invalid Name: " + b);
        if (!_validateType(c)) throw new Error("Invalid Type: " + c);
        d.push(b),
          e.push(c),
          m(name + ".schema_columnName", d),
          m(name + ".schema_columnType", e);
      },
      w = function (a, b, c) {
        var h,
          i,
          j,
          d = l(a + ".schema_columnName"),
          e = l(a + ".schema_columnType"),
          f = [];
        h = void 0 != c ? "" + c : q();
        for (i in d)
          (j = b[d[i]]),
            void 0 == j
              ? (console.warn("Column '" + d[i] + "' is missing from record."),
                (f[i] = ""))
              : (f[i] = g(j, e[i]));
        return m(a + "." + h, f), o(a + ".guidList", h), h;
      },
      x = function (a, b, c, d) {
        var g,
          e = l(c + "." + d),
          f = {};
        if (0 == e.length) return void 0;
        for (g in a) f[a[g]] = h(e[g], b[g]);
        return (f._id = d), f;
      },
      y = function (a, b) {
        var c = l(a + ".schema_columnName"),
          d = l(a + ".schema_columnType");
        return x(c, d, a, b);
      },
      z = function (b, c) {
        var j,
          d = l(b + ".schema_columnName"),
          e = l(b + ".schema_columnType"),
          f = [];
        if (!a.isArray(c))
          throw new Error("_db_readMultiple Invalid array: " + c);
        for (j in c) f.push(x(d, e, b, c[j]));
        return f;
      },
      A = function (a, b, c) {
        var i,
          d = l(a + ".schema_columnName"),
          e = l(a + ".schema_columnType"),
          f = l(a + "." + b);
        for (i in d)
          (n = c[d[i]]),
            void 0 == n
              ? console.warn("Column '" + d[i] + "' is missing from record.")
              : (f[i] = g(n, e[i]));
        m(a + "." + b, f);
      },
      B = function (a, b) {
        console.log("db delete " + b),
          p(a + ".guidList", "" + b),
          localStorage.removeItem(j + "." + a + "." + b);
      },
      C = function (b, c) {
        if (!a.isArray(c))
          throw new Error("_db_deleteMultiple Invalid array: " + c);
        var d, e;
        for (d in c)
          (e = "" + c[d]),
            p(b + ".guidList", e),
            localStorage.removeItem(j + "." + b + "." + e);
      },
      D = function (a, b, c) {
        var g,
          h,
          d = l(a + ".guidList"),
          e = [];
        for (g in d) (h = parseInt(d[g])), b > h || h >= c || e.push("" + h);
        return z(a, e);
      },
      E = function (b, c) {
        var e,
          d = l(b + ".guidList");
        for (e in d) d[e] = parseInt(d[e]);
        return (d = a.sort(d)), c > d.length && (c = d.length), d.splice(0, c);
      };
    (a.db_tableExists = function (a) {
      return c(), t(a);
    }),
      (a.db_newTable = function (a, b) {
        return c(), u(a, b);
      }),
      (a.db_addColumn = function (a, b, d) {
        return c(), v(a, b, d);
      }),
      (a.db_create = function (a, b, d) {
        return c(), w(a, b, d);
      }),
      (a.db_read = function (a, b) {
        return c(), y(a, b);
      }),
      (a.db_readMultiple = function (a, b) {
        return c(), z(a, b);
      }),
      (a.db_update = function (a, b, d) {
        return c(), A(a, b, d);
      }),
      (a.db_delete = function (a, b) {
        return c(), B(a, b);
      }),
      (a.db_deleteMultiple = function (a, b) {
        return c(), C(a, b);
      }),
      (a.db_queryGuidRange = function (a, b, d) {
        return c(), D(a, b, d);
      }),
      (a.db_queryGuidGetLowest = function (a, b) {
        return c(), E(a, b);
      }),
      (a.webStorageAvailable = function () {
        return b();
      }),
      (a.setGlobalKey = function (a) {
        j = a;
      }),
      (a.getGlobalKey = function () {
        return j;
      }),
      (a.requestQuota = (function () {
        var a = function (a) {
            console.log("File System Error: ", a);
          },
          b = function (a) {
            console.log(
              "File System Request Successful!   Name: " +
                a.name +
                ", Root: " +
                a.root
            );
          };
        return function (c, d, e) {
          (d = d || b),
            (e = e || a),
            i
              ? navigator.webkitPersistentStorage.requestQuota(
                  c,
                  function (a) {
                    window.webkitRequestFileSystem(PERSISTENT, a, d, e);
                  },
                  e
                )
              : console.log("No webkitPersistentStorage");
        };
      })()),
      (a.queryUsageAndQuota = function (a, b) {
        (a =
          a ||
          function (a, b) {
            console.log("Used quota: " + a + ", remaining quota: " + b);
          }),
          (b =
            b ||
            function (a) {
              console.log("Query Usage Error", a);
            }),
          i
            ? navigator.webkitPersistentStorage.queryUsageAndQuota(function (
                b,
                c
              ) {
                a(b, c);
              },
              b)
            : console.log("No webkitPersistentStorage");
      }),
      (a.localSet = function (a, b, d) {
        var e;
        c(), (e = g(b, d)), (localStorage[j + "." + a] = e);
      }),
      (a.localGet = function (a, b) {
        var d;
        return c(), (d = localStorage[j + "." + a]), h(d, b);
      }),
      (a.localDelete = function (a) {
        return c(), localStorage.removeItem(j + "." + a);
      }),
      (a.localArrayClear = function (a) {
        c(), (localStorage[j + "." + a] = void 0);
      }),
      (a.localArraySet = function (a, b, d) {
        var f,
          h,
          e = [];
        for (c(), h = b.length, f = 0; h > f; f += 1) e[f] = g(b[f], d);
        localStorage[j + "." + a] = e.join("Â¬");
      }),
      (a.localArrayRemoveValue = function (b, c, d) {
        var e = a.localArrayGet(b, d);
        e = e || [];
        var f = a.arrayRemoveValue(e, c);
        a.localArraySet(b, f, d);
      }),
      (a.localArrayAppend = function (b, c, d) {
        var e = a.localArrayGet(b, d);
        (e = e || []), e.push(c), a.localArraySet(b, e, d);
      }),
      (a.localAppendIfNotInArray = function (b, c, d) {
        var e = a.localArrayGet(b, d);
        return (
          (e = e || []),
          e.indexOf(c) >= 0 ? !1 : (e.push(c), a.localArraySet(b, e, d), !0)
        );
      }),
      (a.localArrayReplaceLast = function (b, c, d) {
        var f,
          e = a.localArrayGet(b, d);
        (e = e || []),
          (f = e.length - 1),
          0 > f && (f = 0),
          (e[f] = c),
          a.localArraySet(b, e, d);
      }),
      (a.localArrayGet = function (a, b) {
        var d,
          e,
          g,
          i,
          f = [];
        if (
          (c(),
          (d = localStorage[j + "." + a]),
          void 0 == d || "undefined" == d)
        )
          return void 0;
        for (e = d.split("Â¬"), i = e.length, g = 0; i > g; g += 1)
          f[g] = h(e[g], b);
        return f;
      }),
      (a.localClearAllData = function () {
        if (!j) throw new Error("No Global Key Set!!!!");
        var a,
          b,
          c,
          d,
          e = [];
        for (c = j.length, b = localStorage.length, a = 0; b > a; a += 1)
          (d = localStorage.key(a)), d.slice(0, c) == j && e.push(d);
        for (a in e) localStorage.removeItem(e[a]);
      }),
      (a.localStorageLog = function (b) {
        void 0 == b && (b = !1);
        var c,
          d,
          e,
          f = "\r\n",
          g = "";
        for (
          d = localStorage.length,
            g += "https/beginlocalstorage/index_3211316.html" + f,
            c = 0;
          d > c;
          c += 1
        )
          (e = localStorage.key(c)),
            (g += e),
            b && (g += ": " + localStorage[e]),
            (g += f);
        (g +=
          "//End localStorage////////////////////////////////////////////////////////////////////////////" +
          f),
          a.getDLURLfromString(g, "localStorageLog_txt_8061021.html");
      });
  }),
  (Tengu.modules.tween = function (a) {
    (a.getSine = function (b, c) {
      var e,
        d = a.now();
      return (
        c && (d += c % b),
        (e = d % b),
        (e /= b),
        (e *= 2 * Math.PI),
        (Math.sin(e) + 1) / 2
      );
    }),
      (a.middleSquare = function (a) {
        for (
          var g, h, b = a, c = 64, d = c / 2, e = c / 4, f = Math.pow(2, c);
          f > b;

        )
          b *= a;
        return (
          (f = Math.pow(2, d + e)),
          (g = Math.pow(2, e)),
          (h = Math.pow(2, d)),
          (b %= f),
          (b = Math.floor(b / g)),
          (b /= h)
        );
      }),
      (a.getSmoothNoise = function (b) {
        var c = Math.floor(a.now() / b),
          d = c + 1,
          e = (a.now() % b) / b,
          f = a.middleSquare(c),
          g = a.middleSquare(d);
        return f * (1 - e) + g * e;
      }),
      (a.getIntervalRot = function (b, c) {
        var d = (a.now() % b) / b;
        return c || (d = 1 - d), 4 * d * Math.PI;
      }),
      (a.getIntervalDiscrete = function (b, c) {
        var d = (a.now() % b) / b;
        return Math.floor(d * c);
      }),
      (a.arcFadeIn = function (a) {
        var b = 1 - a;
        return 1 - Math.sqrt(1 - b * b);
      }),
      (a.arcFadeOut = function (a) {
        return Math.sqrt(1 - a * a);
      }),
      (a.Tween = function () {
        (this.time = []),
          (this.nCallback = []),
          this.time.push(0),
          (this.startTime = a.now()),
          (this.data = {}),
          (this.callback = null),
          (this.state = 0);
      }),
      (a.Tween.prototype.addInterval = function (a, b) {
        var c = this.time.length - 1;
        this.time.push(this.time[c] + a), b && (this.nCallback[c + 1] = b);
      }),
      (a.Tween.prototype.setStartTime = function (b) {
        this.startTime = a.now() + b;
      }),
      (a.Tween.prototype.restart = function () {
        (this.startTime = a.now()), this.update();
      }),
      (a.Tween.prototype.setCallback = function (a) {
        this.callback = a;
      }),
      (a.Tween.prototype.update = function () {
        var d,
          e,
          f,
          g,
          b = a.now(),
          c = 0;
        for (d = 0; d < this.time.length; d += 1)
          b >= this.time[d] + this.startTime && (c = d);
        this.state != c &&
          (this.callback && this.callback({ n: c }),
          this.nCallback[c] && this.nCallback[c](),
          (this.state = c)),
          (e = -1),
          c < this.time.length - 1 &&
            ((f = this.time[c + 1] - this.time[c]),
            (g = b - (this.time[c] + this.startTime)),
            (e = g / f)),
          (this.data = { n: c, t: e });
      }),
      (a.Tween.prototype.getIndex = function () {
        return this.data.n;
      }),
      (a.Tween.prototype.getTween = function (a) {
        if (void 0 == a) return this.data.t;
        var b = this.data.n;
        return a > b ? 0 : b == a ? this.data.t : b > a ? 1 : void 0;
      });
  }),
  (Tengu.modules.geoloc = function (a) {
    var e,
      f,
      g,
      h,
      i,
      j,
      b = function (b) {
        console.log("Geoloc Success: ", b),
          (j = a.date() - i),
          (b.date = i),
          (b.response_time = j),
          (h = b),
          void 0 != g && g(b);
      },
      c = function (a) {
        console.warn("Geoloc Error: (" + a.code + "): " + a.message);
      },
      d = function (d, h, j) {
        return (
          console.log("Geoloc Called"),
          (g = h),
          (j = j || c),
          (i = a.date()),
          navigator.geolocation
            ? (e = navigator.geolocation[d](b, j, f))
            : (console.warn("ERROR: navigator.geolocation is unavailable"), !1)
        );
      };
    (a.getLastCoords = function () {
      if (h) {
        var a = h,
          b = [a.coords.latitude, a.coords.longitude];
        return b;
      }
      return void 0;
    }),
      (a.getLastGeoloc = function () {
        return a.clone(h);
      }),
      (a.setGeolocOptions = function (a, b, c) {
        f = {
          enableHighAccuracy: a || !1,
          timeout: b || 1 / 0,
          maximumAge: c || 0,
        };
      }),
      (a.pingGeoloc = function (b, c) {
        return a.getGeoloc(b, c);
      }),
      (a.getGeoloc = function (a, b) {
        return d("getCurrentPosition", a, b);
      }),
      (a.watchGeoloc = function (a, b) {
        return (id = d("watchPosition", a, b));
      }),
      (a.clearWatchGeoloc = function (a) {
        (a = a || e),
          navigator.geolocation
            ? navigator.geolocation.clearWatch(a)
            : console.warn("ERROR: navigator.geolocation is unavailable");
      });
  }),
  (Tengu.modules.date = function (a) {
    var f,
      c =
        (window.performance || {},
        function () {
          (this.callstack = []), (this.index = 0), (this.looping = !1);
        }),
      d = function (a) {
        return (
          (a.getHours() < 10 ? "0" : "") +
          a.getHours() +
          ":" +
          (a.getMinutes() < 10 ? "0" : "") +
          a.getMinutes() +
          ":" +
          (a.getSeconds() < 10 ? "0" : "") +
          a.getSeconds()
        );
      },
      e = function (a, b, c, d, e, f, g, h, i) {
        var k,
          j = new Date(a);
        if (
          (void 0 != c && j.setMonth(c),
          void 0 != d && j.setDate(d),
          void 0 != e)
        ) {
          for (
            k = e - j.getDay(), console.log("dd", k, e, j.getDay());
            -6 > k;

          )
            k += 7;
          for (; k > 0; ) k -= 7;
          j.setTime(j.getTime() + 864e5 * k);
        }
        return (
          void 0 != f && j.setHours(f),
          void 0 != g && j.setMinutes(g),
          void 0 != h && j.setSeconds(h),
          void 0 != i && j.setMilliseconds(i),
          j.getTime()
        );
      };
    !(function (a) {
      var b,
        c = ["now", "webkitNow", "msNow", "mozNow"];
      if (a.performance)
        for (var d = 0; d < c.length; ++d) {
          var e = c[d];
          if (a.performance[e]) {
            b = function () {
              return a.performance[e]();
            };
            break;
          }
        }
      b || (b = Date.now), (a.perfNow = b);
    })(window),
      (a.now = function () {
        return window.perfNow();
      }),
      (c.prototype._loop = function () {
        var b, c;
        for (c in this.callstack)
          (b = this.callstack[c]),
            b.t <= a.now() && (b.c(), this.callstack.splice(c, 1));
        (this.looping = !1),
          this.callstack.length > 0 &&
            ((this.looping = !0),
            setTimeout(a.createCallback(this, this._loop, null), 0));
      }),
      (c.prototype.set = function (b, c) {
        var d = a.now() + c;
        return (
          (this.callstack[this.index] = { n: this.index, c: b, t: d }),
          (this.index += 1),
          this.looping || this._loop(),
          this.index - 1
        );
      }),
      (c.prototype.clear = function (a) {
        var b;
        for (b in this.callstack)
          this.callstack[b].n == a && this.callstack.splice(b, 1);
      }),
      (f = new c()),
      (a.date = function () {
        return new Date().getTime();
      }),
      (a.parseDate = function (a) {
        var b = new Date(a);
        return b.getTime();
      }),
      (a.getYear = function (a) {
        var b = new Date(a);
        return b.getFullYear();
      }),
      (a.getHourSpan = function (a, b) {
        return (b - a) / 36e5;
      }),
      (a.getAMPM = function (a) {
        var b = new Date(a);
        return b.getHours() >= 12 ? "PM" : "AM";
      }),
      (a.dhmsToMs = function (a) {
        var d,
          b = 0,
          c = { d: 864e5, h: 36e5, m: 6e4, s: 1e3 };
        for (d in a) c[d] && (b += c[d] * a[d]);
        return b;
      }),
      (a.dhmsStringSingle = function (a) {
        var b = 864e5,
          c = 36e5,
          d = 6e4,
          e = 1e3;
        return a > b
          ? "" + Math.round(a / b) + "d"
          : a > c
          ? "" + Math.round(a / c) + "h"
          : a > d
          ? "" + Math.round(a / d) + "m"
          : "" + Math.round(a / e) + "s";
      }),
      (a.hmsString = function (b) {
        var c = Math.floor(b / 36e5),
          d = Math.floor((b % 36e5) / 6e4),
          e = Math.floor((b % 6e4) / 1e3),
          f = "";
        return (
          (f += a.numToString_minDigits(c, 2) + ":"),
          (f += a.numToString_minDigits(d, 2) + ":"),
          (f += a.numToString_minDigits(e, 2))
        );
      }),
      (a.msToHourMinString = function (a) {
        var b = "",
          c = Math.floor(a / 36e5),
          d = Math.floor((a % 36e5) / 6e4);
        return c && ((b += c + "h"), d && (b += " ")), d && (b += d + "m"), b;
      }),
      (a.getLast_midnight = function (a) {
        return e(a, void 0, void 0, void 0, void 0, 0, 0, 0, 0);
      }),
      (a.getLast_sunday = function (b) {
        var c = e(b, void 0, void 0, void 0, 0, 0, 0, 0, 0);
        return a.getLast_midnight(c);
      }),
      (a.getLast_firstOfMonth = function (a) {
        var b = e(a, void 0, void 0, 1, void 0, 0, 0, 0, 0);
        return b;
      }),
      (a.getLast_firstOfYear = function (a) {
        var b = e(a, void 0, 0, 1, void 0, 0, 0, 0, 0);
        return b;
      }),
      (a.getNext_firstOfYear = function (b) {
        var c = a.getLast_firstOfYear(b),
          d = new Date(c);
        return d.setFullYear(d.getFullYear() + 1), d.getTime();
      }),
      (a.getNext_firstOfMonth = function (b) {
        var c = a.getLast_firstOfMonth(b),
          d = new Date(c),
          e = d.getMonth() + 1;
        return e >= 12 && (e -= 12), d.setMonth(e), d.getTime();
      }),
      (a.daysInMonth = function (a) {
        var b = new Date(a);
        return new Date(b.getFullYear(), b.getMonth() + 1, 0).getDate();
      });
    var g = function (a) {
      var b = new Date(a);
      return b.getMonth();
    };
    (a.getMonthName_short = function (a) {
      var b = [
        "Jan",
        "Feb",
        "Mar",
        "Apr",
        "May",
        "Jun",
        "Jul",
        "Aug",
        "Sep",
        "Oct",
        "Nov",
        "Dec",
      ];
      return b[g(a)];
    }),
      (a.getMonthName = function (a) {
        var b = [
          "January",
          "February",
          "March",
          "April",
          "May",
          "June",
          "July",
          "August",
          "September",
          "October",
          "November",
          "December",
        ];
        return b[g(a)];
      }),
      (a.addHours = function (a, b) {
        return a + 36e5 * b;
      }),
      (a.addDays = function (a, b) {
        return a + 864e5 * b;
      }),
      (a.addWeeks = function (a, b) {
        return a + 6048e5 * b;
      }),
      (a.addMonths = function (a, b) {
        var c = new Date(a),
          d = c.getMonth(),
          e = 0;
        for (d += b; d >= 12; ) (d -= 12), (e += 1);
        for (; 0 > d; ) (d += 12), (e -= 1);
        return c.setFullYear(c.getFullYear() + e), c.setMonth(d), c.getTime();
      }),
      (a.addYears = function (a, b) {
        var c = new Date(a);
        return c.setFullYear(c.getFullYear() + b), c.getTime();
      }),
      (a.dateToTimeStamp = function (a) {
        var c,
          b = new Date(a);
        return (
          (b.f = function () {
            var a = this.getFullYear() + "-";
            return (
              (a +=
                (this.getMonth() + 1 < 10 ? "0" : "") +
                (this.getMonth() + 1) +
                "-"),
              (a += (this.getDate() < 10 ? "0" : "") + this.getDate() + "_"),
              (a += d(this))
            );
          }),
          (c = b.f()),
          delete b,
          c
        );
      }),
      (a.dateToTimeString = function (a, b) {
        var d,
          c = new Date(a);
        return (
          (c.f = function () {
            var a = b;
            if ("date_only" == a) return this.toLocaleDateString();
            var c = this.toLocaleTimeString(),
              d = c.substr(0, c.length - 6),
              e = c.substr(c.length - 3, 3);
            return "time_only" == a
              ? d + e
              : ((c = d + e + "  "), (c += this.toLocaleDateString()));
          }),
          (d = c.f()),
          delete c,
          d
        );
      }),
      (a.dateToHourString = function (b) {
        return a.dateToTimeString(b, "time_only");
      }),
      (a.dateToDateString = function (b) {
        return a.dateToTimeString(b, "date_only");
      }),
      (a.setTimeout = function (a, b) {
        return f.set(a, b);
      }),
      (a.clearTimeout = function (a) {
        f.clear(a);
      });
  }),
  (Tengu.modules.draw = function (a) {
    var b = 0.4330127018922193;
    (a.drawCircle = function (a, b, c, d) {
      a.beginPath(), a.arc(b, c, d, 0, 2 * Math.PI, !1);
    }),
      (a.drawLine = function (a, b, c, d, e) {
        a.beginPath(), a.moveTo(b, c), a.lineTo(d, e), a.stroke();
      }),
      (a.drawTriangle = function (a, b, c, d, e, f) {
        (e = e || 1), void 0 == f && (f = !1);
        var h,
          g = [];
        for (h = 0; 3 > h; h += 1) g[h] = { x: d[h].x * e, y: d[h].y * e };
        a.beginPath(),
          a.moveTo(b + g[0].x, c + g[0].y),
          a.lineTo(b + g[1].x, c + g[1].y),
          a.lineTo(b + g[2].x, c + g[2].y),
          a.closePath();
      }),
      (a.drawTriRect = function (a, b, c, d, e, f) {
        var k,
          g = d / 2 + b,
          h = e / 2 + c,
          i = d + b,
          j = e + c;
        switch (f) {
          case "left":
            k = [
              { x: b, y: h },
              { x: i, y: c },
              { x: i, y: j },
            ];
            break;
          case "right":
            k = [
              { x: i, y: h },
              { x: b, y: c },
              { x: b, y: j },
            ];
            break;
          case "down":
            k = [
              { x: g, y: j },
              { x: b, y: c },
              { x: i, y: c },
            ];
            break;
          case "up":
          default:
            k = [
              { x: g, y: c },
              { x: b, y: j },
              { x: i, y: j },
            ];
        }
        a.beginPath(),
          a.moveTo(k[0].x, k[0].y),
          a.lineTo(k[1].x, k[1].y),
          a.lineTo(k[2].x, k[2].y),
          a.closePath();
      }),
      (a.drawEqTri = function (c, d, e, f, g) {
        var i,
          j,
          h = [
            { x: 0, y: -0.5 },
            { x: -b, y: 0.25 },
            { x: b, y: 0.25 },
          ];
        switch (g) {
          case "right":
            for (i = 0; 3 > i; i += 1)
              (j = -1 * h[i].y), (h[i].y = h[i].x), (h[i].x = j);
            break;
          case "left":
            for (i = 0; 3 > i; i += 1)
              (j = h[i].y), (h[i].y = h[i].x), (h[i].x = j);
            break;
          case "down":
            for (i = 0; 3 > i; i += 1) h[i].y *= -1;
            break;
          case "up":
        }
        a.drawTriangle(c, d, e, h, f);
      }),
      (a.drawPath = function (b, c, d, e, f) {
        var g, h, i, j, k;
        for (
          k = { x: c, y: d },
            g = f.split(/[\s,]/i),
            j = null,
            h = 0,
            i = g.length;
          i > h;
          h++
        )
          switch (g[h].toLowerCase()) {
            case "m":
            case "l":
            case "c":
            case "z":
            case "h":
            case "v":
            case "a":
              (j = g[h]), "z" == j.toLowerCase() && b.closePath();
              break;
            default:
              switch (j.toLowerCase()) {
                case "m":
                  a.isUpperCase(j)
                    ? ((k.x = c + g[h] * e), (k.y = d + g[h + 1] * e))
                    : ((k.x += g[h] * e), (k.y += g[h + 1] * e)),
                    b.moveTo(k.x, k.y),
                    (h += 1),
                    (j = "l");
                  break;
                case "l":
                  a.isUpperCase(j)
                    ? ((k.x = c + g[h] * e), (k.y = d + g[h + 1] * e))
                    : ((k.x += g[h] * e), (k.y += g[h + 1] * e)),
                    b.lineTo(k.x, k.y),
                    (h += 1);
                  break;
                case "h":
                  a.isUpperCase(j) ? (k.x = c + g[h] * e) : (k.x += g[h] * e),
                    b.lineTo(k.x, k.y);
                  break;
                case "v":
                  a.isUpperCase(j) ? (k.y = d + g[h] * e) : (k.y += g[h] * e),
                    b.lineTo(k.x, k.y);
                  break;
                case "c":
                  if (a.isUpperCase(j)) {
                    var l = { x: c + g[h] * e, y: d + g[h + 1] * e },
                      m = { x: c + g[h + 2] * e, y: d + g[h + 3] * e };
                    (k.x = c + g[h + 4] * e), (k.y = d + g[h + 5] * e);
                  } else {
                    var l = { x: k.x + g[h] * e, y: k.y + g[h + 1] * e },
                      m = { x: k.x + g[h + 2] * e, y: k.y + g[h + 3] * e };
                    (k.x += g[h + 4] * e), (k.y += g[h + 5] * e);
                  }
                  b.bezierCurveTo(l.x, l.y, m.x, m.y, k.x, k.y), (h += 5);
                  break;
                case "a":
                  var n = g[h] * e,
                    o = g[h + 1] * e,
                    s = (g[h + 2], g[h + 3], g[h + 4], g[h + 5] * e),
                    t = g[h + 6] * e;
                  a.isUpperCase(j)
                    ? ((n += c), (o += d), (s += c), (t += d))
                    : ((n += k.x), (o += k.y), (s += k.x), (t += k.y)),
                    (h += 6);
                  break;
                case "Z":
                case "z":
                  b.closePath();
                  break;
                default:
                  window.console && window.console.log(g[h]);
              }
          }
      });
  }),
  (Tengu.modules.graph = function (a) {
    a.now, (a.method = function () {});
  }),
  (Tengu.modules.image = function (a) {
    var j,
      b = {},
      c = !1,
      d = function (b) {
        var c;
        return (c = "string" == typeof b ? a.newImgFrame(b) : b);
      },
      e = function (a) {
        (b[a].loaded = !0), f();
      },
      f = function () {
        var c,
          a = !0;
        for (c in b) b[c].loaded || (a = !1);
        return void 0 !== j && a && j(), a;
      },
      g = function (a) {
        var e,
          f,
          c = a,
          d = b[a.filename];
        return void 0 == d
          ? (console.error(
              "imgFrameZeroWidthCheck - img not found:",
              a.filename
            ),
            !1)
          : ((e = d.img),
            (f = d.loaded)
              ? ((c.sw <= 0 || c.sh <= 0) &&
                  ((c.sw = e.width),
                  (c.sh = e.height),
                  (c.ox = c.sw / 2),
                  (c.oy = c.sh / 2)),
                !0)
              : !1);
      },
      i = function (a, c, d, e, f, g, h, i) {
        var j = c,
          k = b[j.filename].img,
          l = b[j.filename].loaded;
        return l
          ? (void 0 === d && (d = j.sx),
            void 0 === e && (e = j.sy),
            void 0 === f && (f = 1),
            void 0 === g && (g = 1),
            void 0 === h && (h = 0),
            void 0 === i && (i = 1),
            a.save(),
            (a.globalAlpha *= i),
            a.translate(d, e),
            a.rotate(h),
            a.scale(f, g),
            a.translate(-j.ox, -j.oy),
            a.drawImage(k, j.sx, j.sy, j.sw, j.sh, 0, 0, j.sw, j.sh),
            a.restore(),
            !0)
          : !1;
      };
    (a.imgGetWidth = function (a) {
      var b = d(a);
      return b.sw;
    }),
      (a.imgGetHeight = function (a) {
        var b = d(a);
        return b.sh;
      }),
      (a.getImage = function (a) {
        return b[a];
      }),
      (a.isLoaded = function (a) {
        return 1 == b[a].loaded;
      }),
      (a.setImgLoadCallback = function (a) {
        return (j = a), a;
      }),
      (a.loadImage = function (a, d) {
        var f;
        return void 0 !== b[a]
          ? a
          : ((c = !1),
            (f = new Image()),
            (f.onload = function () {
              e(a), void 0 !== d && d(a);
            }),
            (b[a] = {}),
            (b[a].img = f),
            (b[a].loaded = !1),
            (f.src = a),
            a);
      }),
      (a.loadCanvasAsImage = function (a, d, f) {
        var g;
        return void 0 !== b[d]
          ? d
          : ((c = !1),
            (g = new Image()),
            (g.onload = function () {
              e(d), void 0 !== f && f(d);
            }),
            (b[d] = {}),
            (b[d].img = g),
            (b[d].loaded = !1),
            (g.src = a.toDataURL("image/png")),
            d);
      }),
      (a.newImgFrame = function (b, c, d, e, f) {
        var h = {
          filename: b,
          sx: c || 0,
          sy: d || 0,
          sw: e || 0,
          sh: f || 0,
          ox: e / 2,
          oy: e / 2,
          update: function () {
            g(this);
          },
          setOrigin: function (a, b) {
            (ox = a), (oy = b);
          },
          isLoaded: function () {
            return a.isLoaded(this.filename);
          },
          getBbox: function () {
            return { x: -this.ox, y: -this.oy, w: this.sw, h: this.sh };
          },
        };
        return h.update(), h;
      }),
      (a.drawImage = function (b, c, e, f, g, h, i, j) {
        var k = d(c);
        return (
          (g = g || k.sw),
          (h = h || k.sh),
          a.drawImgFrame(b, k, e, f, g / k.sw, h / k.sh, i, j)
        );
      }),
      (a.drawImgFrame = function (a, b, c, e, f, h, j, k) {
        console.log("Drawin imag fram", b)
        var l = d(b);
        return g(l) ? i(a, l, c, e, f, h, j, k) : !1;
      });
  }),
  (Tengu.modules.imagedata = function (a) {
    (a.createImageData = function (a, b, c) {
      return a.createImageData(b, c);
    }),
      (a.getImageDataBitArray = function (a) {
        return a.data;
      }),
      (a.getImageDataResolution = function (a) {
        return a.resolution;
      });
  }),
  (Tengu.modules.fullscreen = function (a) {
    var b = function (a) {
        a.requestFullscreen
          ? a.requestFullscreen()
          : a.mozRequestFullScreen
          ? a.mozRequestFullScreen()
          : a.webkitRequestFullscreen
          ? a.webkitRequestFullscreen()
          : a.msRequestFullscreen && a.msRequestFullscreen();
      },
      c = function () {
        document.exitFullscreen
          ? document.exitFullscreen()
          : document.mozCancelFullScreen
          ? document.mozCancelFullScreen()
          : document.webkitExitFullscreen && document.webkitExitFullscreen();
      },
      d = function () {
        return document.fullscreenEnabled ||
          document.mozFullscreenEnabled ||
          document.webkitIsFullScreen
          ? !0
          : !1;
      };
    (a.setFullScreen = function () {
      b(document.documentElement);
    }),
      (a.exitFullScreen = function () {
        c();
      }),
      (a.isFullScreen = function () {
        return d();
      }),
      (a.toggleFullScreen = function () {
        d() ? a.exitFullScreen() : a.setFullScreen();
      });
  }),
  (Tengu.modules.fps = function (a) {
    var b = null,
      c = 0.9,
      d = null,
      e = -1,
      f = null;
    (a.fpsCycle = function () {
      var g = a.now();
      return f
        ? ((e = d),
          (d = (g - f) * (1 - c) + e * c),
          (f = g),
          e >= 0 ? (b = 1e3 / d) : null)
        : ((f = g), null);
    }),
      (a.fpsGet = function () {
        return b;
      });
  }),
  (Tengu.modules.canvas = function (a) {
    var b = !1,
      c = function () {
        var a = '<a id="dlLink"></a>';
        if (
          ((a += '<p id="textDiv"></p>'),
          (a += '<div id="stretch" overflow="hidden">'),
          (a += '<div id="garbage"></div>'),
          (a +=
            '<canvas id="mainCanvas" width="0" height="0" overflow="hidden" position="fixed"></canvas>'),
          (a +=
            '<div id="canvasOverlay" overflow="hidden" position="fixed"></div>'),
          (a += '<div id="fadeOverlay" position="fixed"></div>'),
          (a += "</div>"),
          (a += '<span id="debug"></span>'),
          (document.ontouchmove = function (a) {
            a.preventDefault();
          }),
          !document.body)
        )
          throw new Error("document.body doesn't exist!");
        (document.body.innerHTML += a),
          document.body.style ||
            (console.warn(
              "document.body.style not initialized, initializing now"
            ),
            (document.body.style = {})),
          (document.body.style.overflow = "hidden");
      },
      d = function () {
        return document.getElementById("canvasOverlay") ? !0 : !1;
      },
      e = function () {
        return document.getElementById("canvasOverlay");
      },
      f = function () {
        return document.body.getElementsByTagName("canvas")[0];
      },
      g = function (a, b, c, d) {
        var g, h;
        (g = f()),
          (h = e()),
          (g.width = c),
          (g.height = d),
          (h.style.width = c),
          (h.style.height = d);
      },
      h = {
        update: function () {
          (document.body.style.zoom = 1),
            (document.body.style.MozTransform = "scale(1)"),
            (document.body.style.WebkitTransform = "scale(1)");
          var a;
          (b = !0),
            (this.canvas = f()),
            (this.overlay = e()),
            (this.ctx = this.canvas.getContext("2d")),
            (a = this.canvas),
            k && g(0, 0, window.innerWidth, window.innerHeight),
            (this.w = a.width),
            (this.h = a.height),
            (this.cx = a.width / 2),
            (this.cy = a.height / 2),
            (this.vertical = a.height > a.width),
            (this.scalar = a.height / 960);
        },
      },
      i = function () {
        d() || c(), h.update();
      },
      j = function () {
        var b = a.clone(h);
        return (b.canvas = h.canvas), (b.ctx = h.ctx), b;
      },
      k = !1;
    $(document).ready(i),
      (a.canvasFillScreen = function (a) {
        return void 0 === a && (a = !0), (k = a);
      }),
      (a.canvasSetAntiAlias = function (a) {
        h.ctx.webkitImageSmoothingEnabled = a;
      }),
      (a.setCanvasRect = function (a, b, c, d) {
        void 0 == c && void 0 == d && ((c = a), (d = b), (a = 0), (b = 0)),
          g(a, b, c, d);
      }),
      (a.updateCanvasData = function () {
        return (
          b || console.warn("Can't get canvas, document isn't ready yet!"),
          h.update(),
          j()
        );
      }),
      (a.getCanvasData = function () {
        return (
          b || console.warn("Can't get canvas, document isn't ready yet!"), j()
        );
      }),
      (a.getCtx = function () {
        return a.getCanvasData.ctx;
      });
  }),
  (Tengu.modules.canvasmanip = function (a) {
    var b = function (a) {
        return a instanceof HTMLImageElement;
      },
      c = function (a) {
        var b = a.getContext("2d");
        return b.clearRect(0, 0, a.width, a.height), a;
      },
      d = function (a, b) {
        var c = document.createElement("canvas");
        return (
          (c.width = a),
          (c.height = b),
          (c.ctx = c.getContext("2d")),
          (c.clear = function () {
            c.ctx.save(),
              c.ctx.setTransform(1, 0, 0, 1, 0, 0),
              c.ctx.clearRect(0, 0, c.width, c.height),
              c.ctx.restore();
          }),
          c
        );
      },
      e = function (a) {
        var b = d(a.width, a.height),
          c = b.getContext("2d");
        return c.drawImage(a, 0, 0), b;
      },
      f = function (a, b) {
        var g,
          i,
          j,
          c = [],
          e = a.width,
          f = a.height;
        for (g in b) {
          if (((i = b[g]), "number" != typeof i.w))
            throw new Error("Invalid w: " + w + " at index: " + g);
          if ("number" != typeof i.h)
            throw new Error("Invalid h: " + h + " at index: " + g);
          (j = d(i.w, i.h)),
            j.ctx.drawImage(a, 0, 0, e, f, 0, 0, i.w, i.h),
            (c[g] = j);
        }
        return c;
      },
      g = function (b) {
        var d = b,
          e = a.newElement("canvas"),
          f = b.width,
          g = b.height;
        return (
          (e.width = f),
          (e.height = g),
          (e.clear = function () {
            c(d);
          }),
          (e.drawFunction = function (a, b) {
            var c = 0,
              f = 0;
            switch (e.halign) {
              case "center":
                c = b.width / 2;
                break;
              case "right":
                c = b.width;
            }
            switch (e.valign) {
              case "middle":
                f = b.height / 2;
                break;
              case "bottom":
                f = b.height;
            }
            a.ctx.drawImage(
              d,
              0,
              0,
              d.width,
              d.height,
              b.x - c,
              b.y - f,
              b.width,
              b.height
            );
          }),
          (e.getCanvas = function () {
            return d;
          }),
          (e.setCanvas = function (a) {
            (e.width = a.width), (e.height = a.height), (d = a);
          }),
          e
        );
      };
    (a.newCanvasElement = function (a) {
      return g(a);
    }),
      (a.newCanvas = function (c, f) {
        if ("string" == typeof c && ((c = a.getImage(c)), !c))
          throw new Error(c + " image not found.");
        return b(c) ? e(c) : d(c, f);
      }),
      (a.drawCanvas = function (a, b, c, d, e, f, g, h, i, j) {
        a.drawImage(b, c, d, e, f, g, h, i, j);
      }),
      (a.mipmapCanvas = function (a, b) {
        return f(a, b);
      });
  }),
  (Tengu.modules.canvasDraw = function (a) {
    (a.drawLine = function (a, b, c, d, e) {
      a.beginPath(), a.moveTo(b, c), a.lineTo(d, e), a.stroke();
    }),
      (a.fillRect = function (a, b) {
        a.fillRect(b.x, b.y, b.w, b.h);
      }),
      (a.strokeRect = function (a, b) {
        a.strokeRect(b.x, b.y, b.w, b.h);
      });
  }),
  (Tengu.modules.pointer = function () {
    !(function () {
      function g(a) {
        var b = k("down", a);
        if (!b) return !1;
        var d = b.mouse || (b.touch && 1 === a.touches.length);
        !c &&
          d &&
          ((a.target.maybeClick = !0),
          (a.target.maybeClickX = b.x),
          (a.target.maybeClickY = b.y));
      }
      function h(a) {
        (a.target.maybeClick = !1), k("leave", a);
      }
      function i(a) {
        k("move", a);
      }
      function j(a) {
        var b = k("up", a);
        return b
          ? (a.target.maybeClick &&
              Math.abs(a.target.maybeClickX - b.x) < 5 &&
              Math.abs(a.target.maybeClickY - b.y) < 5 &&
              (!c ||
                (Math.abs(e - window.pageXOffset) < 5 &&
                  Math.abs(f - window.pageYOffset) < 5)) &&
              k("click", a),
            (a.target.maybeClick = !1),
            void 0)
          : !1;
      }
      function k(b, c) {
        var d = c.target;
        if (a && 0 === c.type.indexOf("mouse")) return !1;
        var e = document.createEvent("CustomEvent");
        return (
          e.initCustomEvent("pointer" + b, !0, !0, {}),
          (e.touch = 0 === c.type.indexOf("touch")),
          (e.mouse = 0 === c.type.indexOf("mouse")),
          e.touch && (a = !0),
          e.touch &&
            ((e.x = c.changedTouches[0].pageX),
            (e.y = c.changedTouches[0].pageY)),
          e.mouse &&
            ((e.x = c.clientX + window.pageXOffset),
            (e.y = c.clientY + window.pageYOffset)),
          (e.maskedEvent = c),
          d.dispatchEvent(e),
          e
        );
      }
      var a = !1,
        b = document,
        c = !1,
        d = !1,
        e = 0,
        f = 0;
      window.addEventListener("scroll", function () {
        c || ((e = window.pageXOffset), (f = window.pageYOffset)),
          (c = !0),
          clearTimeout(d),
          (d = setTimeout(function () {
            (c = !1), (e = 0), (f = 0);
          }, 100));
      }),
        b.addEventListener("mousedown", g),
        b.addEventListener("touchstart", g),
        b.addEventListener("mouseup", j),
        b.addEventListener("touchend", j),
        b.addEventListener("mousemove", i),
        b.addEventListener("touchmove", i),
        b.addEventListener("mouseout", h),
        b.addEventListener("touchleave", h);
    })();
  }),
  (Tengu.modules.gui = function (a) {
    var s,
      w,
      y,
      z,
      A,
      b = function (b, c) {
        var d = function (b, c) {
            return "number" == typeof b
              ? b
              : a.isString(b)
              ? -1 == b.indexOf("%")
                ? parseFloat(b)
                : (parseFloat(b) / 100) * c
              : void 0;
          },
          e = {};
        return (
          (e.x = d(b.x, c.width)),
          (e.width = d(b.width, c.width)),
          (e.y = d(b.y, c.height)),
          (e.height = d(b.height, c.height)),
          e
        );
      },
      c = function () {
        return document.getElementById("fadeOverlay");
      },
      e = function (a, b, d, e) {
        var f = c(),
          g = [a, b, d, e];
        (f.style.background = "rgba(" + g.join(",") + ")"),
          0 >= e
            ? ((f.style.width = 0), (f.style.height = 0))
            : ((f.style.width = "100%"), (f.style.height = "100%"));
      },
      f = function (b) {
        (this.id = b),
          (this.element = []),
          (this.x = 0),
          (this.y = 0),
          (this.z = 0),
          (this.width = "100%"),
          (this.height = "100%"),
          (this.halign = "center"),
          (this.valign = "middle"),
          (this.visible = !0),
          (this.disabled = !1),
          (this._pressed = !1),
          (this._over = !1),
          (this.alpha = 1),
          (this.parent = null),
          (this.scale = 1),
          (this.mirror = !1),
          (this.flip = !1),
          (this.imgFrame = null),
          (this.preDrawFunction = function () {}),
          (this.drawFunction = function () {}),
          (this.postDrawFunction = function () {}),
          (this._drawbbox = !1),
          (this.bbox = { x: 0, y: 0, w: 0, h: 0 }),
          (this._bbox = { x: 0, y: 0, w: 0, h: 0 }),
          (this.positioning = "relative"),
          (this._create_timestamp = a.now());
      },
      g = function (a) {
        var b = new f(a);
        return (
          (b.stopPropagation = (function () {
            var a = this;
            return function () {
              l.call(a);
            };
          })()),
          b
        );
      },
      i = function (c, d, e) {
        var j,
          l,
          m,
          f = c,
          h = d.ctx;
        if (void 0 === e) {
          switch (((j = g()), f.halign)) {
            case "left":
              j.x = 0;
              break;
            case "right":
              j.x = d.w;
              break;
            case "center":
              j.x = d.cx;
          }
          switch (f.valign) {
            case "top":
              j.y = 0;
              break;
            case "bottom":
              j.y = d.h;
              break;
            case "middle":
              j.y = d.cy;
          }
          (j.width = d.w), (j.height = d.h), (j.scale = d.scalar);
        } else if (((j = a.clone(e)), !f.fit_to_parent)) {
          switch (f.halign) {
            case "left":
              j.x = e.x;
              break;
            case "right":
              j.x = e.x + e.width;
              break;
            case "center":
              j.x = e.x + e.width / 2;
          }
          switch (f.valign) {
            case "top":
              j.y = e.y;
              break;
            case "bottom":
              j.y = e.y + e.height;
              break;
            case "middle":
              j.y = e.y + e.height / 2;
          }
        }
        if (
          (f.fit_to_parent ||
            ((m = b(f, j)),
            "number" == typeof f.x && (m.x *= j.scale),
            "number" == typeof f.y && (m.y *= j.scale),
            "number" == typeof f.width && (m.width *= j.scale),
            "number" == typeof f.height && (m.height *= j.scale),
            (j.x += m.x),
            (j.y += m.y),
            (j.width = m.width),
            (j.height = m.height),
            (j.scale *= f.scale),
            (j.halign = f.halign),
            (j.valign = f.valign)),
          (f._bbox = {
            x: j.x + f.bbox.x * j.scale,
            y: j.y + f.bbox.y * j.scale,
            w: f.bbox.w * j.scale,
            h: f.bbox.h * j.scale,
          }),
          void 0 != f.updateFade && f.updateFade(),
          (j.alpha = f.alpha),
          "absolute" == f.positioning &&
            ((j.x = f.x),
            (j.y = f.y),
            (j.width = f.width),
            (j.height = f.height),
            (j.scale = f.scale),
            (f._bbox = a.clone(f.bbox)),
            (f._bbox.x += j.x),
            (f._bbox.y += j.y)),
          f.preDrawFunction.call(f, d, j),
          (j._posToNum = m),
          (f._draw_data = j),
          f.visible)
        ) {
          h.save(),
            f._drawbox &&
              (h.save(),
              (h.strokeStyle =
                void 0 != f._drawbox_color ? f._drawbox_color : "red"),
              h.strokeRect(j.x, j.y, j.width, j.height),
              h.restore()),
            (h.globalAlpha *= j.alpha),
            f._clipToBbox &&
              (h.rect(f._bbox.x, f._bbox.y, f._bbox.w, f._bbox.h), h.clip()),
            f.drawFunction.call(f, d, j),
            f._drawbbox &&
              (h.save(),
              (h.strokeStyle =
                void 0 != f._drawbbox_color ? f._drawbox_color : "red"),
              h.strokeRect(f._bbox.x, f._bbox.y, f._bbox.w, f._bbox.h),
              h.restore());
          for (l in f.element) i(f.element[l], d, j);
          f.postDrawFunction.call(f, d, j), h.restore();
        }
        return f;
      },
      j = function (b, c, d) {
        var f,
          e = !1;
        switch ((void 0 == c && (c = 500), (d = d || function () {}), b)) {
          case "white":
          case "slideLeft":
          case "slideRight":
          case "alpha":
            e = !0;
        }
        if (e)
          return (f = new a.Tween()), f.addInterval(c, d), (f.fade_type = b), f;
        throw new Error("Invalid fade type:  " + b);
      },
      k = void 0,
      l = function () {
        if (void 0 == k)
          throw new Error(
            "Don't call stopPropagation outside of an event handler!"
          );
        k = !1;
      },
      m = function () {
        var d,
          b = a.updateCanvasData(),
          c = s.element;
        for (d in c) i(c[d], b);
        r = window.setTimeout(function () {
          m.call(this);
        }, q);
      },
      n = (function () {
        var a = [
          { etype: "pointerdown", local: "onDown", global: "globalOnDown" },
          { etype: "pointerup", local: "onUp", global: "globalOnUp" },
          { etype: "pointermove", local: "onMove", global: "globalOnMove" },
        ];
        return a;
      })(),
      o = function (b) {
        var c, d, e, f;
        d = n;
        for (e in d)
          if (b.event_type == d[e].etype) {
            switch (
              ((this.globalOnClick = this.onClickAnywhere),
              void 0 != this[d[e].global] && this[d[e].global](b),
              "globalOnDown" == d[e].global &&
                this.globalOnClick &&
                this.globalOnClick(b),
              (f = !1),
              this[d[e].local] && (f = !0),
              d[e].local)
            ) {
              case "onDown":
                (this.onClick || this.onClickOff) && (f = !0);
                break;
              case "onMove":
                (this.onEnter || this.onLeave) && (f = !0);
            }
            if (!this.disabled && f)
              if (a.pointRect(b.x, b.y, this._bbox)) {
                switch (
                  ((c = a.clone(b)), (c.x -= b.x), (c.y -= b.y), d[e].local)
                ) {
                  case "onDown":
                    (this._pressed = !0), this.onClick && this.onClick(b, c);
                    break;
                  case "onUp":
                    this._pressed = !1;
                    break;
                  case "onMove":
                    !this._over && this.onEnter && this.onEnter(b, c),
                      (this._over = !0);
                }
                this[d[e].local] && this[d[e].local](b, c);
              } else
                switch (d[e].local) {
                  case "onDown":
                    this.onClickOff && this.onClickOff(b, c);
                  case "onMove":
                    this._over && this.onLeave && this.onLeave(b, c),
                      this._over &&
                        this._pressed &&
                        this.onUp &&
                        this.onUp(b, c),
                      (this._over = !1),
                      (this._pressed = !1);
                    break;
                  case "onUp":
                    this._pressed = !1;
                }
          }
      },
      p = function (b) {
        var c = a.now(),
          d = w || 0,
          e = v;
        if (((k = !0), (w = c), e > c - d)) return !1;
        var l,
          f = [],
          g = [],
          h = function (a) {
            o.call(this, a),
              f.push(this),
              null != this.parent &&
                -1 == f.indexOf(this.parent) &&
                k &&
                h.call(this.parent, a);
          },
          i = function (a) {
            if (void 0 == a) return !1;
            if (a.disabled) return !1;
            var c,
              d,
              b = a.element;
            if (((d = b.length), d > 0)) for (c = 0; d > c; c += 1) i(b[c]);
            else g.push(a);
          },
          j = s.element;
        for (l in j) i(j[l]);
        for (l in g) h.call(g[l], b);
        k = void 0;
      },
      q = 1,
      r = window.setTimeout(function () {
        m.call(this);
      }, q),
      v = 10;
    (f.prototype = {
      getPressed: function () {
        return this._pressed;
      },
      getOver: function () {
        return this._over;
      },
      getCreateTime: function () {
        return this._create_timestamp;
      },
      addChild: function (a) {
        return this.element.push(a), (a.parent = this), a;
      },
      drawBbox: function (a) {
        void 0 == a && (a = !0),
          "string" == typeof a && ((this._drawbbox_color = a), (a = !0)),
          (this._drawbbox = a);
      },
      drawBox: function (a) {
        void 0 == a && (a = !0),
          "string" == typeof a && ((this._drawbox_color = a), (a = !0)),
          (this._drawbox = a);
      },
      removeChild: function (a) {
        var b = this.element,
          c = b.indexOf(a);
        return (a.parent = null), -1 != c ? b.splice(c, 1) : -1;
      },
      setAlign: function () {
        var b,
          c,
          a = Array.prototype.slice.call(arguments);
        for (c = a.length, b = 0; c > b; b += 1)
          switch (a[b]) {
            case "left":
              this.halign = "left";
              break;
            case "right":
              this.halign = "right";
              break;
            case "center":
              this.halign = "center";
              break;
            case "top":
              this.valign = "top";
              break;
            case "bottom":
              this.valign = "bottom";
              break;
            case "middle":
              this.valign = "middle";
          }
        return this;
      },
      destroy: function () {
        var a;
        for (a in this.element) this.element[a].destroy();
        this.element = [];
      },
      setPositioning: function (a) {
        switch (a) {
          case "relative":
          case "absolute":
            this.positioning = a;
            break;
          default:
            throw new Error("Bad positioning value: " + a);
        }
      },
      setPosition: function (a, b) {
        (this.x = a), (this.y = b);
      },
      setWidthHeight: function (a, b) {
        (this.width = a), (this.height = b);
      },
      setRect: function (b) {
        var c = a.argArray(arguments),
          d = c.length;
        if (1 == d)
          (this.width = b.w),
            (this.height = b.h),
            (this.x = b.x),
            (this.y = b.y);
        else {
          if (4 != d)
            throw new Error(
              "setRect requires either a rect{x,y,w,h}, or 4 arguments"
            );
          (this.width = c[2]),
            (this.height = c[3]),
            (this.x = c[0]),
            (this.y = c[1]);
        }
        (this.scale = 1),
          (this.bbox = { x: 0, y: 0, w: this.width, h: this.height });
      },
      getRect: function () {
        return { x: this.x, y: this.y, w: this.width, h: this.height };
      },
      setBbox: function (a, b, c, d) {
        this.bbox = { x: a, y: b, w: c, h: d };
      },
      setImage: function (b) {
        if (a.isString(b)) this.imgFrame = a.newImgFrame(b);
        else {
          if (!a.isObject(b))
            return (
              console.warn(
                "T.element.setImage(img) - img is not an object or string.  img:",
                b
              ),
              !1
            );
          this.imgFrame = b;
        }
        if (
          (this.imgFrame.update(),
          (this.bbox = this.imgFrame.getBbox()),
          !this.bbox)
        )
          throw new Error("Bad bbox from imgFrame");
        return (
          (this.width = this.bbox.w),
          (this.height = this.bbox.h),
          this.imgFrame.isLoaded()
        );
      },
      clipToBbox: function (a) {
        void 0 == a && (a = !0), (this._clipToBbox = a);
      },
      logParent: function () {
        for (var a = this; null != a; ) console.log(a), (a = a.parent);
      },
      logDrawData: function () {
        for (var a = this; null != a; )
          a._draw_data && console.log(a._draw_data), (a = a.parent);
      },
    }),
      (s = g("document")),
      $(document).ready(function () {
        var b,
          c,
          a = ["pointerdown", "pointerup", "pointermove"];
        for (c = a.length, b = 0; c > b; b += 1)
          window.addEventListener(
            a[b],
            (function (a) {
              return function (b) {
                (b.event_type = a), p(b);
              };
            })(a[b])
          );
        "undefined" == typeof z &&
          ((z = document.createElement("div")),
          (z.style.display = "none"),
          document.body.appendChild(z)),
          (y = function (a) {
            z.appendChild(a), (z.innerHTML = "");
          });
      }),
      (a.clearFadeOverlay = function () {
        e(255, 255, 255, 0);
      }),
      (a.setFramerate = function (a) {
        q = a;
      }),
      (a.tempDrawElement = function (a, b, c) {
        return i(a, b, c);
      }),
      (a.docAddChild = function (a) {
        return s.addChild(a);
      }),
      (a.docRemoveChild = function (a) {
        return s.removeChild(a);
      }),
      (a.newElement = function (a) {
        return g(a);
      }),
      (a.newCanvasTextElement = function () {}),
      (a.newScreenElement = function (b) {
        b = b || "screen";
        var c = g(b);
        return (
          (c.fit_to_parent = !0),
          (c.halign = "left"),
          (c.valign = "top"),
          (c.fadeState = 0),
          (c._fade = { state: 0, value: 0 }),
          (c.updateFade = function () {
            var b,
              c,
              a = this._fade;
            switch (a.state) {
              case 0:
                c = a.tweenIn;
                break;
              case 2:
                c = a.tweenOut;
            }
            if (((this.disabled = !1), void 0 != c)) {
              switch (((this.disabled = !0), a.state)) {
                case 0:
                  void 0 != A && (c.fade_type = A);
                  break;
                case 2:
                  A = c.fade_type;
              }
              switch ((b = c.fade_type)) {
                case "white":
                case "slideRight":
                case "slideLeft":
                case "alpha":
                  c.update(),
                    (x = c.getTween(0)),
                    a.state < 2 && (x = 1 - x),
                    (a.value = x);
              }
            }
          }),
          (c.setFadeIn = function (b, d, e) {
            var f = this._fade,
              g = a.createCallback(c, function () {
                (f.state = 1), void 0 != e && e();
              });
            f.tweenIn = j(b, d, g);
          }),
          (c.fadeOut = function () {
            var a = this._fade;
            (a.state = 2), a.tweenOut.restart(), (this.disabled = !0);
          }),
          (c.setFadeOut = function (b, d, e) {
            var f = this._fade,
              g = a.createCallback(c, function () {
                (f.state = 3), void 0 != e && e(), c.destroy();
              });
            f.tweenOut = j(b, d, g);
          }),
          (c.preDrawFunction = function (a, b) {
            var e,
              g,
              h,
              i,
              j,
              k,
              d = (a.ctx, this._fade);
            switch (d.state) {
              case 0:
                e = d.tweenIn;
                break;
              case 2:
                e = d.tweenOut;
            }
            if (void 0 != e)
              switch (e.fade_type) {
                case "alpha":
                  switch (d.state) {
                    case 0:
                      b.alpha = d.value;
                      break;
                    case 2:
                      b.alpha = 1 - d.value;
                  }
                  break;
                case "slideRight":
                case "slideLeft":
                  switch (((g = d.value), (h = 1 - g), d.state)) {
                    case 0:
                      i = 1 - Math.sqrt(1 - g * g);
                      break;
                    case 2:
                      i = Math.sqrt(1 - g * g);
                  }
                  switch (((k = a.w), d.state)) {
                    case 0:
                      j = k * i;
                      break;
                    case 1:
                      j = 0;
                      break;
                    case 2:
                      j = k * i - k;
                      break;
                    case 3:
                      j = -k;
                  }
                  "slideRight" == e.fade_type && (j *= -1), (b.x += j);
              }
          }),
          (c.postDrawFunction = function (a) {
            var f,
              d = (a.ctx, this._fade);
            switch (d.state) {
              case 0:
                f = d.tweenIn;
                break;
              case 2:
                f = d.tweenOut;
            }
            if (void 0 != f)
              switch (f.fade_type) {
                case "white":
                  e(255, 255, 255, d.value);
                  break;
                default:
                  e(255, 255, 255, 0);
              }
          }),
          c
        );
      }),
      (a.newImgElement = function (b) {
        var c = g();
        return (
          c.setImage(b),
          (c.drawFunction = function (b, c) {
            var d = b,
              e = c,
              f = this.imgFrame;
            f.update(), (this.width = f.sw), (this.height = f.sh);
            var k = e.scale,
              l = e.scale;
            this.mirror && (k *= -1),
              this.flip && (l *= -1),
              a.drawImgFrame(
                d.ctx,
                this.imgFrame,
                e.x,
                e.y,
                k,
                l,
                this.rotation
              );
          }),
          (c.defaultDraw = c.drawFunction),
          c
        );
      }),
      (a.newImageElement = a.newImgElement),
      (a.newStaticBgElement = function (b) {
        var c = g(b);
        return (
          (c.drawFunction = function (c, d) {
            var e = c,
              g = a.getImage(b);
            if (g.loaded) {
              var h = !0,
                i = e.w,
                j = e.h,
                k = j > i != h,
                n = 640,
                o = 960,
                t = e.ctx;
              t.save(),
                k
                  ? (t.translate(i, 0),
                    t.rotate(Math.PI / 2),
                    t.drawImage(g.img, 0, 0, n, o, 0, 0, j, i))
                  : t.drawImage(g.img, 0, 0, n, o, 0, 0, i, j),
                t.restore();
            }
          }),
          (c.defaultDraw = c.drawFunction),
          c
        );
      });
  }),
  (Tengu.modules.html = function (a) {
    a.html_createRadioElement = function (a, b) {
      var c = '<input type="radio" name="' + a + '"';
      b && (c += ' checked="checked"'), (c += "/>");
      var d = document.createElement("div");
      return (d.innerHTML = c), d.firstChild;
    };
  }),
  (Tengu.modules.dom = function (a) {
    var b,
      c,
      f,
      g = !1,
      h = !1;
    (window.onload = function () {
      "undefined" == typeof b &&
        ((b = document.createElement("div")),
        (b.style.display = "none"),
        (b.style.zIndex = -100),
        document.body.appendChild(b)),
        (c = function (a) {
          h && console.log("Node Discarded"),
            b.appendChild(a),
            (b.innerHTML = "");
        }),
        (f = (function () {
          var b = a.newElement();
          return b.destroy;
        })());
    }),
      (a.logNodeDiscard = function () {
        h = !0;
      }),
      (a.disableDOMScaling = function (a) {
        void 0 == a && (a = !0), (g = a);
      }),
      (a.newDOMElement = function (b) {
        var d = a.newElement(),
          e = a.getCanvasData(),
          h = e.overlay,
          i = document.createElement(b),
          j = !1;
        return (
          (d._domElement = i),
          (i.style.position = "absolute"),
          "onpropertychange" in i
            ? i.attachEvent(
                $.proxy(function () {
                  "value" == event.propertyName && d.onValueChange(i.value);
                }, i)
              )
            : i.addEventListener(
                "input",
                function () {
                  d.onValueChange(i.value);
                },
                !1
              ),
          i.addEventListener(
            "pointerdown",
            function () {
              void 0 != d.onClickAnywhere && d.onClickAnywhere(),
                void 0 != d.onClick && d.onClick();
            },
            !1
          ),
          (d.setText = function (a) {
            i.innerHTML = a;
          }),
          (d.destroy = function () {
            i && c(i), f.call(d);
          }),
          (d.onValueChange = function () {}),
          (d.preDrawFunction = function (a, b) {
            switch (
              ((i.style.left = b.x),
              (i.style.top = b.y),
              (i.style.width = d.width),
              (i.style.height = d.height),
              (i.style.zIndex = b.z),
              (i.style.fontSize = d.fontSize * b.scale),
              (i.style.visibility = d.visible ? "visible" : "hidden"),
              this.halign)
            ) {
              case "center":
                i.style.left = b.x - b.width / 2;
                break;
              case "right":
                i.style.left = b.x - b.width;
            }
            switch (this.valign) {
              case "middle":
                i.style.top = b.y - b.height / 2;
                break;
              case "bottom":
                i.style.top = b.y - b.height;
            }
            j || ((j = !0), h.appendChild(i)),
              (g && d.scaling_enabled) || !g
                ? ((i.style.transform = "scale(" + b.scale + ")"),
                  (i.style.webkitTransform = "scale(" + b.scale + ")"),
                  (i.style.mozTransform = "scale(" + b.scale + ")"),
                  (i.style.oTransform = "scale(" + b.scale + ")"),
                  (i.style.msTransform = "scale(" + b.scale + ")"),
                  (i.style.left =
                    b.x + 0.5 * -b.width * (1 / b.scale) + 0.05 * b.x),
                  (i.style.top =
                    b.y + 0.5 * -b.height * (1 / b.scale) + 0.05 * b.y))
                : ("auto" != i.style.width && (i.style.width = b.width),
                  "auto" != i.style.height && (i.style.height = b.height));
          }),
          (d.drawFunction = function (a) {
            i.style.opacity = a.ctx.globalAlpha;
          }),
          (d.getValue = function () {
            return i.value;
          }),
          (d.getDOMElement = function () {
            return d._domElement;
          }),
          (d.getDOMStyle = function () {
            return d._domElement.style;
          }),
          (d.setDOMClass = function (a) {
            d._domElement.className = a;
          }),
          (d.setAlpha = function (a) {
            d._domElement.opacity = a;
          }),
          d
        );
      }),
      (a.newCheckboxElement = function (b) {
        var c = a.newDOMElement("input"),
          d = c.getDOMElement();
        return (
          (d.type = "checkbox"),
          (d.defaultChecked = b),
          (d.onclick = function () {
            c.onValueChange(d.checked);
          }),
          (c.isChecked = function () {
            return d.checked;
          }),
          (c.setChecked = function (a) {
            d.checked = a;
          }),
          c
        );
      }),
      (a.newTextElement = function (b) {
        var c = a.newDOMElement("div"),
          d = c.getDOMElement(),
          e = c.preDrawFunction;
        return (
          (d.innerHTML = b),
          (c.fontSize = 30),
          (c.textAlign = "left"),
          (c.textVAlign = "top"),
          (c.preDrawFunction = function (a, b) {
            (d.fontSize = c.fontSize * b.scale),
              (d.style.textAlign = c.textAlign),
              (d.style.verticalAlign = c.textVAlign),
              d.style.textAlign,
              e(a, b);
          }),
          (c.setText = function (a) {
            d.innerHTML = a;
          }),
          c
        );
      });
  });
